<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Week 2 The data frame | 40 Days and 40 Nights</title>
  <meta name="description" content="An ad hoc course to learn R for bioinformatics, using the
COVID-19 epidemic as an excuse." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Week 2 The data frame | 40 Days and 40 Nights" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="An ad hoc course to learn R for bioinformatics, using the
COVID-19 epidemic as an excuse." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Week 2 The data frame | 40 Days and 40 Nights" />
  
  <meta name="twitter:description" content="An ad hoc course to learn R for bioinformatics, using the
COVID-19 epidemic as an excuse." />
  

<meta name="author" content="Martin Morgan" />
<meta name="author" content="L. Shawn Matott" />


<meta name="date" content="2020-04-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="one.html"/>
<link rel="next" href="three.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">QuaRantine</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Motivation</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#introduction"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-to-expect"><i class="fa fa-check"></i>What to expect</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="one.html"><a href="one.html"><i class="fa fa-check"></i><b>1</b> Basics</a><ul>
<li class="chapter" data-level="1.1" data-path="one.html"><a href="one.html#day-1-monday-zoom-orientation"><i class="fa fa-check"></i><b>1.1</b> Day 1 (Monday) Zoom orientation</a><ul>
<li class="chapter" data-level="1.1.1" data-path="one.html"><a href="one.html#logistics-10-minutes"><i class="fa fa-check"></i><b>1.1.1</b> Logistics (10 minutes)</a></li>
<li class="chapter" data-level="1.1.2" data-path="one.html"><a href="one.html#installing-r-and-rstudio-25-minutes-shawn"><i class="fa fa-check"></i><b>1.1.2</b> Installing <em>R</em> and <em>RStudio</em> (25 minutes, Shawn)</a></li>
<li class="chapter" data-level="1.1.3" data-path="one.html"><a href="one.html#basics-of-r-25-minutes"><i class="fa fa-check"></i><b>1.1.3</b> Basics of <em>R</em> (25 minutes)</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="one.html"><a href="one.html#day-2-vectors-and-variables"><i class="fa fa-check"></i><b>1.2</b> Day 2: Vectors and variables</a></li>
<li class="chapter" data-level="1.3" data-path="one.html"><a href="one.html#day-3-factor-date-and-na"><i class="fa fa-check"></i><b>1.3</b> Day 3: <code>factor()</code>, <code>Date()</code>, and <code>NA</code></a></li>
<li class="chapter" data-level="1.4" data-path="one.html"><a href="one.html#day-4-working-with-variables"><i class="fa fa-check"></i><b>1.4</b> Day 4: Working with variables</a></li>
<li class="chapter" data-level="1.5" data-path="one.html"><a href="one.html#day-5-friday-zoom-check-in"><i class="fa fa-check"></i><b>1.5</b> Day 5 (Friday) Zoom check-in</a><ul>
<li class="chapter" data-level="1.5.1" data-path="one.html"><a href="one.html#logistics"><i class="fa fa-check"></i><b>1.5.1</b> Logistics</a></li>
<li class="chapter" data-level="1.5.2" data-path="one.html"><a href="one.html#review-and-trouble-shoot-25-minutes-martin"><i class="fa fa-check"></i><b>1.5.2</b> Review and trouble shoot (25 minutes; Martin)</a></li>
<li class="chapter" data-level="1.5.3" data-path="one.html"><a href="one.html#weekend-activities-25-minutes-shawn"><i class="fa fa-check"></i><b>1.5.3</b> Weekend activities (25 minutes; Shawn)</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="one.html"><a href="one.html#day-6-r-scripts"><i class="fa fa-check"></i><b>1.6</b> Day 6: <em>R</em> scripts</a></li>
<li class="chapter" data-level="1.7" data-path="one.html"><a href="one.html#day-7-saving-data"><i class="fa fa-check"></i><b>1.7</b> Day 7: Saving data</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="two.html"><a href="two.html"><i class="fa fa-check"></i><b>2</b> The data frame</a><ul>
<li class="chapter" data-level="2.1" data-path="two.html"><a href="two.html#day-8-monday-zoom-check-in"><i class="fa fa-check"></i><b>2.1</b> Day 8 (Monday) Zoom check-in</a><ul>
<li class="chapter" data-level="" data-path="two.html"><a href="two.html#logistics-1"><i class="fa fa-check"></i>Logistics</a></li>
<li class="chapter" data-level="" data-path="two.html"><a href="two.html#review-and-troubleshoot-15-minutes"><i class="fa fa-check"></i>Review and troubleshoot (15 minutes)</a></li>
<li class="chapter" data-level="" data-path="two.html"><a href="two.html#the-data-frame-40-minutes"><i class="fa fa-check"></i>The data frame (40 minutes)</a></li>
<li class="chapter" data-level="" data-path="two.html"><a href="two.html#this-weeks-activities-5-minutes"><i class="fa fa-check"></i>This week’s activities (5 minutes)</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="two.html"><a href="two.html#day-9-creation-and-manipulation"><i class="fa fa-check"></i><b>2.2</b> Day 9: Creation and manipulation</a><ul>
<li class="chapter" data-level="" data-path="two.html"><a href="two.html#creation"><i class="fa fa-check"></i>Creation</a></li>
<li class="chapter" data-level="" data-path="two.html"><a href="two.html#column-selection"><i class="fa fa-check"></i>Column selection</a></li>
<li class="chapter" data-level="" data-path="two.html"><a href="two.html#adding-or-updating-columns"><i class="fa fa-check"></i>Adding or updating columns</a></li>
<li class="chapter" data-level="" data-path="two.html"><a href="two.html#reading-and-writing"><i class="fa fa-check"></i>Reading and writing</a></li>
<li class="chapter" data-level="" data-path="two.html"><a href="two.html#reading-from-a-remote-file"><i class="fa fa-check"></i>Reading from a remote file (!)</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="two.html"><a href="two.html#day-10-subset-with-and-within"><i class="fa fa-check"></i><b>2.3</b> Day 10: <code>subset()</code>, <code>with()</code>, and <code>within()</code></a><ul>
<li><a href="two.html#subset"><code>subset()</code></a></li>
<li><a href="two.html#with"><code>with()</code></a></li>
<li><a href="two.html#within"><code>within()</code></a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="two.html"><a href="two.html#day-11-aggregate-and-an-initial-work-flow"><i class="fa fa-check"></i><b>2.4</b> Day 11: <code>aggregate()</code> and an initial work flow</a><ul>
<li><a href="two.html#aggregate-for-summarizing-columns-by-group"><code>aggregate()</code> for summarizing columns by group</a></li>
<li class="chapter" data-level="" data-path="two.html"><a href="two.html#an-initial-work-flow"><i class="fa fa-check"></i>An initial work flow</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="two.html"><a href="two.html#day-12-friday-zoom-check-in"><i class="fa fa-check"></i><b>2.5</b> Day 12 (Friday) Zoom check-in</a><ul>
<li class="chapter" data-level="" data-path="two.html"><a href="two.html#review-and-troubleshoot-20-minutes"><i class="fa fa-check"></i>Review and troubleshoot (20 minutes)</a></li>
<li class="chapter" data-level="" data-path="two.html"><a href="two.html#visualization-20-minutes"><i class="fa fa-check"></i>Visualization (20 minutes)</a></li>
<li class="chapter" data-level="" data-path="two.html"><a href="two.html#functions-20-minutes"><i class="fa fa-check"></i>Functions (20 minutes)</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="two.html"><a href="two.html#day-13-basic-visualization"><i class="fa fa-check"></i><b>2.6</b> Day 13: Basic visualization</a></li>
<li class="chapter" data-level="2.7" data-path="two.html"><a href="two.html#day-14-functions"><i class="fa fa-check"></i><b>2.7</b> Day 14: Functions</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="three.html"><a href="three.html"><i class="fa fa-check"></i><b>3</b> Packages and the ‘tidyverse’</a><ul>
<li class="chapter" data-level="3.1" data-path="three.html"><a href="three.html#day-15-monday-zoom-check-in"><i class="fa fa-check"></i><b>3.1</b> Day 15 (Monday) Zoom check-in</a><ul>
<li class="chapter" data-level="3.1.1" data-path="three.html"><a href="three.html#cran"><i class="fa fa-check"></i><b>3.1.1</b> [CRAN][]</a></li>
<li class="chapter" data-level="3.1.2" data-path="three.html"><a href="three.html#the-tidyverse-of-packages"><i class="fa fa-check"></i><b>3.1.2</b> The ‘tidyverse’ of packages</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="three.html"><a href="three.html#day-16-key-tidyverse-packages-readr-and-dplyr"><i class="fa fa-check"></i><b>3.2</b> Day 16 Key tidyverse packages: [readr][] and [dplyr][]</a></li>
<li class="chapter" data-level="3.3" data-path="three.html"><a href="three.html#day-17-visualization-with-ggplot2"><i class="fa fa-check"></i><b>3.3</b> Day 17 Visualization with [ggplot2][]</a></li>
<li class="chapter" data-level="3.4" data-path="three.html"><a href="three.html#day-18-worldwide-covid-data"><i class="fa fa-check"></i><b>3.4</b> Day 18 Worldwide COVID data</a></li>
<li class="chapter" data-level="3.5" data-path="three.html"><a href="three.html#day-19-friday-zoom-check-in"><i class="fa fa-check"></i><b>3.5</b> Day 19 (Friday) Zoom check-in</a><ul>
<li class="chapter" data-level="3.5.1" data-path="three.html"><a href="three.html#review-and-trouble-shoot-25-minutes"><i class="fa fa-check"></i><b>3.5.1</b> Review and trouble shoot (25 minutes)</a></li>
<li class="chapter" data-level="3.5.2" data-path="three.html"><a href="three.html#next-week-25-minutes"><i class="fa fa-check"></i><b>3.5.2</b> Next week (25 minutes)</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="three.html"><a href="three.html#day-20-exploring-the-course-of-pandemic-in-different-regions"><i class="fa fa-check"></i><b>3.6</b> Day 20 Exploring the course of pandemic in different regions</a></li>
<li class="chapter" data-level="3.7" data-path="three.html"><a href="three.html#day-21"><i class="fa fa-check"></i><b>3.7</b> Day 21</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="four.html"><a href="four.html"><i class="fa fa-check"></i><b>4</b> Maps and spatial statistics</a><ul>
<li class="chapter" data-level="4.1" data-path="four.html"><a href="four.html#day-22-monday-zoom-check-in"><i class="fa fa-check"></i><b>4.1</b> Day 22 (Monday) Zoom check-in</a></li>
<li class="chapter" data-level="4.2" data-path="four.html"><a href="four.html#day-23"><i class="fa fa-check"></i><b>4.2</b> Day 23</a></li>
<li class="chapter" data-level="4.3" data-path="four.html"><a href="four.html#day-24"><i class="fa fa-check"></i><b>4.3</b> Day 24</a></li>
<li class="chapter" data-level="4.4" data-path="four.html"><a href="four.html#day-25"><i class="fa fa-check"></i><b>4.4</b> Day 25</a></li>
<li class="chapter" data-level="4.5" data-path="four.html"><a href="four.html#day-26-friday-zoom-check-in"><i class="fa fa-check"></i><b>4.5</b> Day 26 (Friday) Zoom check-in</a><ul>
<li class="chapter" data-level="4.5.1" data-path="four.html"><a href="four.html#review-and-trouble-shoot-25-minutes-1"><i class="fa fa-check"></i><b>4.5.1</b> Review and trouble shoot (25 minutes)</a></li>
<li class="chapter" data-level="4.5.2" data-path="four.html"><a href="four.html#next-week-25-minutes-1"><i class="fa fa-check"></i><b>4.5.2</b> Next week (25 minutes)</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="four.html"><a href="four.html#day-27"><i class="fa fa-check"></i><b>4.6</b> Day 27</a></li>
<li class="chapter" data-level="4.7" data-path="four.html"><a href="four.html#day-28"><i class="fa fa-check"></i><b>4.7</b> Day 28</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="five.html"><a href="five.html"><i class="fa fa-check"></i><b>5</b> Bioinformatics with <span>Bioconductor</span></a><ul>
<li class="chapter" data-level="5.1" data-path="five.html"><a href="five.html#day-29-monday-zoom-check-in"><i class="fa fa-check"></i><b>5.1</b> Day 29 (Monday) Zoom check-in</a></li>
<li class="chapter" data-level="5.2" data-path="five.html"><a href="five.html#day-30"><i class="fa fa-check"></i><b>5.2</b> Day 30</a></li>
<li class="chapter" data-level="5.3" data-path="five.html"><a href="five.html#day-31"><i class="fa fa-check"></i><b>5.3</b> Day 31</a></li>
<li class="chapter" data-level="5.4" data-path="five.html"><a href="five.html#day-32"><i class="fa fa-check"></i><b>5.4</b> Day 32</a></li>
<li class="chapter" data-level="5.5" data-path="five.html"><a href="five.html#day-33-friday-zoom-check-in"><i class="fa fa-check"></i><b>5.5</b> Day 33 (Friday) Zoom check-in</a><ul>
<li class="chapter" data-level="5.5.1" data-path="five.html"><a href="five.html#review-and-trouble-shoot-25-minutes-2"><i class="fa fa-check"></i><b>5.5.1</b> Review and trouble shoot (25 minutes)</a></li>
<li class="chapter" data-level="5.5.2" data-path="five.html"><a href="five.html#next-week-25-minutes-2"><i class="fa fa-check"></i><b>5.5.2</b> Next week (25 minutes)</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="five.html"><a href="five.html#day-34"><i class="fa fa-check"></i><b>5.6</b> Day 34</a></li>
<li class="chapter" data-level="5.7" data-path="five.html"><a href="five.html#day-35"><i class="fa fa-check"></i><b>5.7</b> Day 35</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="six.html"><a href="six.html"><i class="fa fa-check"></i><b>6</b> Collaboration</a><ul>
<li class="chapter" data-level="6.1" data-path="six.html"><a href="six.html#days-monday-zoom-check-in"><i class="fa fa-check"></i><b>6.1</b> 5 Days (Monday) Zoom check-in</a></li>
<li class="chapter" data-level="6.2" data-path="six.html"><a href="six.html#days"><i class="fa fa-check"></i><b>6.2</b> 4 Days</a></li>
<li class="chapter" data-level="6.3" data-path="six.html"><a href="six.html#days-1"><i class="fa fa-check"></i><b>6.3</b> 3 Days</a></li>
<li class="chapter" data-level="6.4" data-path="six.html"><a href="six.html#days-2"><i class="fa fa-check"></i><b>6.4</b> 2 Days</a></li>
<li class="chapter" data-level="6.5" data-path="six.html"><a href="six.html#today-friday-zoom-check-in"><i class="fa fa-check"></i><b>6.5</b> Today! (Friday) Zoom check-in</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="frequently-asked-questions.html"><a href="frequently-asked-questions.html"><i class="fa fa-check"></i>Frequently asked questions</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">40 Days and 40 Nights</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="two" class="section level1">
<h1><span class="header-section-number">Week 2</span> The data frame</h1>
<div id="day-8-monday-zoom-check-in" class="section level2">
<h2><span class="header-section-number">2.1</span> Day 8 (Monday) Zoom check-in</h2>
<div id="logistics-1" class="section level3 unnumbered">
<h3>Logistics</h3>
<ul>
<li><p>Remember to use the <a href="https://teams.microsoft.com/l/channel/19%3a44e8ed2b03db4d28bac6a212ed67717d%40thread.tacv2/General?groupId=02d8c183-5110-4504-b201-ace342eb6e2b&amp;tenantId=08beaa21-c9ff-428a-b8f5-53c03dad1941">QuaRantine</a> Microsoft Team. Your Roswell credentials are required, and you must have been invited (by Adam.Kisailus at RoswellPark.org)</p></li>
<li><p>We’re thinking of having a ‘networking’ hour after Friday’s class (so 3pm and after) where we’ll break into smaller groups (if necessary) and provide an opportunity for people to turn on their video and audio so that we can increase the amount of intereaction. Likely the first networking hour will be a round of introductions / what you hope to get out of the course / etc., and maybe brief discussion of topics arising.</p></li>
</ul>
</div>
<div id="review-and-troubleshoot-15-minutes" class="section level3 unnumbered">
<h3>Review and troubleshoot (15 minutes)</h3>
<p>Saving and loading objects</p>
<p>Scripts</p>
</div>
<div id="the-data-frame-40-minutes" class="section level3 unnumbered">
<h3>The data frame (40 minutes)</h3>
<div id="concept" class="section level4 unnumbered">
<h4>Concept</h4>
<p>Recall from Day 1:</p>
<ul>
<li><p>Data frames are handy containers for experimental data.</p></li>
<li><p>Like a spreadsheet, a data frame has rows and columns</p></li>
<li><p>The columns of a data frame contain measurements describing each individual</p>
<ul>
<li>Each measurement could refer to a different type of object (numeric, string, etc.)</li>
<li>Measurements could be physical observations on samples, e.g., <code>height</code>, <code>weight</code>, <code>age</code>, <code>minutes</code> an activity lasts, etc.</li>
<li>Measurements might also describe how the row is classified, e.g., <code>activity</code>, <code>is work?</code>, <code>classification</code>, <code>date</code>, etc.</li>
</ul></li>
<li><p>The rows of a data frame represent a ‘tuple’ of measurements corresponding to an experimental observation, e.g.,</p>
<ul>
<li>Note: you must ensure units are consistent across tuples!</li>
</ul></li>
<li><p>Rows and columns can be assigned names.</p></li>
</ul>
</div>
<div id="create-a-simple-data-frame" class="section level4 unnumbered">
<h4>Create a simple data frame</h4>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">heights &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">72</span>, <span class="dv">65</span>, <span class="dv">68</span>)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">weights &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">190</span>, <span class="dv">130</span>, <span class="dv">150</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">ages &lt;-<span class="st">  </span><span class="kw">c</span>(<span class="dv">44</span>, <span class="dv">35</span>, <span class="dv">37</span>)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(heights, weights, ages)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">df</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">##   heights weights ages</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co">## 1      72     190   44</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">## 2      65     130   35</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">## 3      68     150   37</span></a></code></pre></div>
<p>It’s possible to update the column names, and to provide row names…</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">named_df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(heights, weights, ages)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw">colnames</span>(named_df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;hgt_inches&quot;</span>, <span class="st">&quot;wgt_lbs&quot;</span>, <span class="st">&quot;age_years&quot;</span>)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw">rownames</span>(named_df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;John Doe&quot;</span>, <span class="st">&quot;Pat Jones&quot;</span>, <span class="st">&quot;Sara Grant&quot;</span>)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">named_df</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">##            hgt_inches wgt_lbs age_years</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">## John Doe           72     190        44</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">## Pat Jones          65     130        35</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">## Sara Grant         68     150        37</span></a></code></pre></div>
<p>…but it’s often better practice to name columns at time of creation, and to store all information as columns (rather than designating one column as a ‘special’ row name)</p>
<ul>
<li><p>Here’s our first attempt</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">    <span class="dt">person =</span> <span class="kw">c</span>(<span class="st">&quot;John Doe&quot;</span>, <span class="st">&quot;Pat Jones&quot;</span>, <span class="st">&quot;Sara Grant&quot;</span>),</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">    <span class="dt">hgt_inches =</span> heights, <span class="dt">wgt_lbs =</span> weights, <span class="dt">age_years =</span> ages</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">)</a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">##       person hgt_inches wgt_lbs age_years</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">## 1   John Doe         72     190        44</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">## 2  Pat Jones         65     130        35</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">## 3 Sara Grant         68     150        37</span></a></code></pre></div></li>
<li><p>It’s unsatisfactory because by default <em>R</em> treats character vectors as <code>factor</code>. We’d like them to plain-old character vectors. To accomplish this, we add the <code>stringsAsFactors = FALSE</code> argument</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">    <span class="dt">person =</span> <span class="kw">c</span>(<span class="st">&quot;John Doe&quot;</span>, <span class="st">&quot;Pat Jones&quot;</span>, <span class="st">&quot;Sara Grant&quot;</span>),</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">    <span class="dt">hgt_inches =</span> heights, <span class="dt">wgt_lbs =</span> weights, <span class="dt">age_years =</span> ages,</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">    <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5">)</a>
<a class="sourceLine" id="cb4-6" data-line-number="6">df</a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">##       person hgt_inches wgt_lbs age_years</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">## 1   John Doe         72     190        44</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">## 2  Pat Jones         65     130        35</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">## 3 Sara Grant         68     150        37</span></a></code></pre></div></li>
</ul>
</div>
<div id="adding-and-deleting-rows" class="section level4 unnumbered">
<h4>Adding and deleting rows</h4>
<p>Adding rows</p>
<ul>
<li><p>Add a row with <code>rbind()</code></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">more_people &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Bob Kane&quot;</span>, <span class="st">&quot;Kari Patra&quot;</span>, <span class="st">&quot;Sam Groe&quot;</span>)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">more_heights &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">61</span>, <span class="dv">68</span>, <span class="dv">70</span>)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">more_weights &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">101</span>, <span class="dv">134</span>, <span class="dv">175</span>)</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">more_ages &lt;-<span class="st">  </span><span class="kw">c</span>(<span class="dv">13</span>, <span class="dv">16</span>, <span class="dv">24</span>)</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">more_df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">    <span class="dt">person =</span> more_people,</a>
<a class="sourceLine" id="cb5-7" data-line-number="7">    <span class="dt">hgt_inches =</span> more_heights, <span class="dt">wgt_lbs =</span> more_weights, <span class="dt">age_years =</span> more_ages,</a>
<a class="sourceLine" id="cb5-8" data-line-number="8">    <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9">)</a>
<a class="sourceLine" id="cb5-10" data-line-number="10"></a>
<a class="sourceLine" id="cb5-11" data-line-number="11">df_all &lt;-<span class="st"> </span><span class="kw">rbind</span>(df, more_df)</a>
<a class="sourceLine" id="cb5-12" data-line-number="12">df_all</a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">##       person hgt_inches wgt_lbs age_years</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">## 1   John Doe         72     190        44</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co">## 2  Pat Jones         65     130        35</span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co">## 3 Sara Grant         68     150        37</span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="co">## 4   Bob Kane         61     101        13</span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="co">## 5 Kari Patra         68     134        16</span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="co">## 6   Sam Groe         70     175        24</span></a></code></pre></div></li>
<li><p><em>R</em> often has more than one way to perform an operation. We’ll see <code>add_rows()</code> later in the course.</p></li>
</ul>
<p>Delete rows using a logical vector…</p>
<ul>
<li><p>Create a logical or numeric index indicating the rows to be deleted</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co">## suppose the study has some dropouts ....</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">dropouts &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Bob Kane&quot;</span>, <span class="st">&quot;John Doe&quot;</span>)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co">## create a logical vector indicating which rows should be dropped</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5">drop &lt;-<span class="st"> </span>df_all<span class="op">$</span>person <span class="op">%in%</span><span class="st"> </span>dropouts</a>
<a class="sourceLine" id="cb6-6" data-line-number="6"></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">## ...but we actually want to know which rows to `keep`</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8">keep &lt;-<span class="st"> </span><span class="op">!</span>drop</a></code></pre></div></li>
<li><p>Subset the data frame with the logical vector indicating the rows we would like to keep</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">df_all[keep,]</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="co">##       person hgt_inches wgt_lbs age_years</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">## 2  Pat Jones         65     130        35</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">## 3 Sara Grant         68     150        37</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">## 5 Kari Patra         68     134        16</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">## 6   Sam Groe         70     175        24</span></a></code></pre></div></li>
</ul>
<p>…or a numeric vector</p>
<ul>
<li><p>Create a vector containing the rows to be deleted</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># suppose the study has some dropouts ....</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">dropouts =<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</a></code></pre></div></li>
<li><p>Use a minus sign <code>-</code> to indicated that these rows should be <em>dropped</em>, rather than kept</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">df_all <span class="co"># referesh my memory about df contents ....</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="co">##       person hgt_inches wgt_lbs age_years</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co">## 1   John Doe         72     190        44</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">## 2  Pat Jones         65     130        35</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">## 3 Sara Grant         68     150        37</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co">## 4   Bob Kane         61     101        13</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="co">## 5 Kari Patra         68     134        16</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co">## 6   Sam Groe         70     175        24</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9">df_remaining &lt;-<span class="st"> </span>df_all[<span class="op">-</span>dropouts, ]</a>
<a class="sourceLine" id="cb9-10" data-line-number="10"></a>
<a class="sourceLine" id="cb9-11" data-line-number="11">df_remaining <span class="co"># items 2 and 3 are dropped!</span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"><span class="co">##       person hgt_inches wgt_lbs age_years</span></a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="co">## 1   John Doe         72     190        44</span></a>
<a class="sourceLine" id="cb9-14" data-line-number="14"><span class="co">## 4   Bob Kane         61     101        13</span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="co">## 5 Kari Patra         68     134        16</span></a>
<a class="sourceLine" id="cb9-16" data-line-number="16"><span class="co">## 6   Sam Groe         70     175        24</span></a></code></pre></div></li>
</ul>
</div>
<div id="some-useful-data-frame-operations" class="section level4 unnumbered">
<h4>Some useful data frame operations</h4>
<p>Try these out on your simple data frames <code>df</code> and <code>named_df</code>:</p>
<ul>
<li><code>str(df)      # structure (NOT string!)(sorry Python programmers ;)</code></li>
<li><code>dim(df)      # dimensions</code></li>
<li><code>View(df)     # open tabular view of data frame</code></li>
<li><code>head(df)     # first few rows</code></li>
<li><code>tail(df)     # last few rows</code></li>
<li><code>names(df)    # column names</code></li>
<li><code>colnames(df) # column names</code></li>
<li><code>rownames(df) # row names</code></li>
</ul>
</div>
<div id="writing-reading-and-spreadhseets" class="section level4 unnumbered">
<h4>Writing, reading, and spreadhseets</h4>
<p>Saving a <code>data.frame</code></p>
<ul>
<li><p>We <em>could</em> save the <code>data.frame</code> as an <em>R</em> object, using the methods from quarantine day 7</p></li>
<li><p>Often, better practice (e.g., to make it easy to share data with others in our lab) is to save data as a text file</p></li>
<li><p>A ‘csv’ file is one example</p>
<ul>
<li>A plain text file</li>
<li>The first line contains column names</li>
<li>Each line of the text file represents a row of the data frame</li>
<li>Columns within a row are separated by a comma, <code>,</code></li>
</ul></li>
<li><p>Example: save <code>df_all</code> to a temporary file location</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">file &lt;-<span class="st"> </span><span class="kw">tempfile</span>() <span class="co"># temporary file</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co">## file &lt;- file.choose()</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co">## file &lt;- &quot;df_all.csv&quot;</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co">## file &lt;- &quot;/Users/ma38737/MyQuarantine/df_all.csv&quot;</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="kw">write.csv</span>(df_all, file, <span class="dt">row.names =</span> <span class="ot">FALSE</span>)</a></code></pre></div></li>
<li><p>now, read the data back in from the temporary location</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">df_all_from_file &lt;-<span class="st"> </span><span class="kw">read.csv</span>(file, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">df_all_from_file</a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co">##       person hgt_inches wgt_lbs age_years</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co">## 1   John Doe         72     190        44</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co">## 2  Pat Jones         65     130        35</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co">## 3 Sara Grant         68     150        37</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">## 4   Bob Kane         61     101        13</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="co">## 5 Kari Patra         68     134        16</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="co">## 6   Sam Groe         70     175        24</span></a></code></pre></div></li>
</ul>
<p><em>R</em> and spreadsheets</p>
<ul>
<li><p>A CSV file is a common way to move data from <em>R</em> to a spreadsheet, and vice versa. Following along with the example above, write <code>df_all</code> to a CSV file.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">file &lt;-<span class="st"> &quot;/Users/ma38727/MyQuarantine/df_all.csv&quot;</span> <span class="co"># a location on (my) disk</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="kw">write.csv</span>(df_all, file, <span class="dt">row.names =</span> <span class="ot">FALSE</span>)</a></code></pre></div></li>
<li><p>Now open a spreadsheet application like Excel and navigate to the directory containing the file</p>
<p><img src="images/Excel-1.png" width="782" /></p></li>
<li><p>… and open the file</p>
<p><img src="images/Excel-2.png" width="612" /></p></li>
<li><p>To go from Excel to <em>R</em>, make sure your spreadsheet is a simple rectangular table of rows and columns, without ‘merged’ cells or fancy column formating, or… i.e., your spreadsheet should be as simple as the one we imported from <em>R</em>. Then save the file in CSV format</p>
<p><img src="images/Excel-3.png" width="640" /></p></li>
<li><p>…and import it into <em>R</em></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">df_all_from_Excel &lt;-<span class="st"> </span><span class="kw">read.csv</span>(</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">    <span class="st">&quot;/Users/ma38727/MyQuarantine/df_all_from_Excel.csv&quot;</span>,</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">    <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4">)</a></code></pre></div></li>
</ul>
</div>
<div id="an-alternative-way-of-working-with-data.frame" class="section level4 unnumbered">
<h4>An alternative way of working with <code>data.frame()</code></h4>
<ul>
<li><code>with()</code>: column selection and computation</li>
<li><code>within()</code>: update or add columns</li>
<li><p><code>subset()</code>: row and column subset</p></li>
<li><p>Our quarantine log, day 1</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">activity &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;check e-mail&quot;</span>, <span class="st">&quot;breakfast&quot;</span>, <span class="st">&quot;conference call&quot;</span>, <span class="st">&quot;webinar&quot;</span>, <span class="st">&quot;walk&quot;</span>)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">minutes &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">60</span>, <span class="dv">60</span>, <span class="dv">60</span>)</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">is_work &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">TRUE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb14-4" data-line-number="4"></a>
<a class="sourceLine" id="cb14-5" data-line-number="5">levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;connect&quot;</span>, <span class="st">&quot;exercise&quot;</span>, <span class="st">&quot;consult&quot;</span>, <span class="st">&quot;hobby&quot;</span>, <span class="st">&quot;essential&quot;</span>)</a>
<a class="sourceLine" id="cb14-6" data-line-number="6">classification &lt;-<span class="st"> </span><span class="kw">factor</span>(</a>
<a class="sourceLine" id="cb14-7" data-line-number="7">    <span class="kw">c</span>(<span class="st">&quot;connect&quot;</span>, <span class="st">&quot;essential&quot;</span>, <span class="st">&quot;connect&quot;</span>, <span class="st">&quot;consult&quot;</span>, <span class="st">&quot;exercise&quot;</span>),</a>
<a class="sourceLine" id="cb14-8" data-line-number="8">    <span class="dt">levels =</span> levels</a>
<a class="sourceLine" id="cb14-9" data-line-number="9">)</a>
<a class="sourceLine" id="cb14-10" data-line-number="10"></a>
<a class="sourceLine" id="cb14-11" data-line-number="11">dates &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;04-14-2020&quot;</span>, <span class="kw">length</span>(activity))</a>
<a class="sourceLine" id="cb14-12" data-line-number="12">date &lt;-<span class="st"> </span><span class="kw">as.Date</span>(dates, <span class="dt">format =</span> <span class="st">&quot;%m-%d-%Y&quot;</span>)</a>
<a class="sourceLine" id="cb14-13" data-line-number="13"></a>
<a class="sourceLine" id="cb14-14" data-line-number="14">log &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb14-15" data-line-number="15">    activity, minutes, is_work, classification, date,</a>
<a class="sourceLine" id="cb14-16" data-line-number="16">    <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb14-17" data-line-number="17">)</a>
<a class="sourceLine" id="cb14-18" data-line-number="18">log</a>
<a class="sourceLine" id="cb14-19" data-line-number="19"><span class="co">##          activity minutes is_work classification       date</span></a>
<a class="sourceLine" id="cb14-20" data-line-number="20"><span class="co">## 1    check e-mail      20    TRUE        connect 2020-04-14</span></a>
<a class="sourceLine" id="cb14-21" data-line-number="21"><span class="co">## 2       breakfast      30   FALSE      essential 2020-04-14</span></a>
<a class="sourceLine" id="cb14-22" data-line-number="22"><span class="co">## 3 conference call      60    TRUE        connect 2020-04-14</span></a>
<a class="sourceLine" id="cb14-23" data-line-number="23"><span class="co">## 4         webinar      60    TRUE        consult 2020-04-14</span></a>
<a class="sourceLine" id="cb14-24" data-line-number="24"><span class="co">## 5            walk      60   FALSE       exercise 2020-04-14</span></a></code></pre></div></li>
</ul>
<p>Summarization</p>
<ul>
<li>Use <code>with()</code> to simplify variable reference</li>
<li><p>Create a new <code>data.frame()</code> containing the summary</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw">with</span>(log, {</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">    <span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb15-3" data-line-number="3">        <span class="dt">days_in_quarantine =</span> <span class="kw">length</span>(<span class="kw">unique</span>(date)),</a>
<a class="sourceLine" id="cb15-4" data-line-number="4">        <span class="dt">total_minutes =</span> <span class="kw">sum</span>(minutes),</a>
<a class="sourceLine" id="cb15-5" data-line-number="5">        <span class="dt">work_activities =</span> <span class="kw">sum</span>(is_work),</a>
<a class="sourceLine" id="cb15-6" data-line-number="6">        <span class="dt">other_activities =</span> <span class="kw">sum</span>(<span class="op">!</span>is_work)</a>
<a class="sourceLine" id="cb15-7" data-line-number="7">    )</a>
<a class="sourceLine" id="cb15-8" data-line-number="8">})</a>
<a class="sourceLine" id="cb15-9" data-line-number="9"><span class="co">##   days_in_quarantine total_minutes work_activities other_activities</span></a>
<a class="sourceLine" id="cb15-10" data-line-number="10"><span class="co">## 1                  1           230               3                2</span></a></code></pre></div></li>
</ul>
<p>Summarization by group</p>
<ul>
<li><p><code>aggregate()</code></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co">## minutes per day spent on each activity, from the quarantine_log</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="kw">aggregate</span>(minutes <span class="op">~</span><span class="st"> </span>activity, log, sum)</a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="co">##          activity minutes</span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="co">## 1       breakfast      30</span></a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="co">## 2    check e-mail      20</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="co">## 3 conference call      60</span></a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="co">## 4            walk      60</span></a>
<a class="sourceLine" id="cb16-8" data-line-number="8"><span class="co">## 5         webinar      60</span></a>
<a class="sourceLine" id="cb16-9" data-line-number="9"></a>
<a class="sourceLine" id="cb16-10" data-line-number="10"><span class="co">## minutes per day spent on each clasasification</span></a>
<a class="sourceLine" id="cb16-11" data-line-number="11"><span class="kw">aggregate</span>(minutes <span class="op">~</span><span class="st"> </span>classification, log, sum)</a>
<a class="sourceLine" id="cb16-12" data-line-number="12"><span class="co">##   classification minutes</span></a>
<a class="sourceLine" id="cb16-13" data-line-number="13"><span class="co">## 1        connect      80</span></a>
<a class="sourceLine" id="cb16-14" data-line-number="14"><span class="co">## 2       exercise      60</span></a>
<a class="sourceLine" id="cb16-15" data-line-number="15"><span class="co">## 3        consult      60</span></a>
<a class="sourceLine" id="cb16-16" data-line-number="16"><span class="co">## 4      essential      30</span></a>
<a class="sourceLine" id="cb16-17" data-line-number="17"></a>
<a class="sourceLine" id="cb16-18" data-line-number="18"><span class="co">## non-work activities per day</span></a>
<a class="sourceLine" id="cb16-19" data-line-number="19"><span class="kw">aggregate</span>(<span class="op">!</span>is_work <span class="op">~</span><span class="st"> </span>date, log, sum)</a>
<a class="sourceLine" id="cb16-20" data-line-number="20"><span class="co">##         date !is_work</span></a>
<a class="sourceLine" id="cb16-21" data-line-number="21"><span class="co">## 1 2020-04-14        2</span></a></code></pre></div></li>
</ul>
</div>
</div>
<div id="this-weeks-activities-5-minutes" class="section level3 unnumbered">
<h3>This week’s activities (5 minutes)</h3>
<p>Goal: retrieve and summarize COVID 19 cases in Erie county and nationally</p>
</div>
</div>
<div id="day-9-creation-and-manipulation" class="section level2">
<h2><span class="header-section-number">2.2</span> Day 9: Creation and manipulation</h2>
<div id="creation" class="section level3 unnumbered">
<h3>Creation</h3>
<p>Last week we created vectors summarizing our quarantine activities</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">activity &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;check e-mail&quot;</span>, <span class="st">&quot;breakfast&quot;</span>, <span class="st">&quot;conference call&quot;</span>, <span class="st">&quot;webinar&quot;</span>, <span class="st">&quot;walk&quot;</span>)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2">minutes &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">60</span>, <span class="dv">60</span>, <span class="dv">60</span>)</a>
<a class="sourceLine" id="cb17-3" data-line-number="3">is_work &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">TRUE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb17-4" data-line-number="4"></a>
<a class="sourceLine" id="cb17-5" data-line-number="5">levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;connect&quot;</span>, <span class="st">&quot;exercise&quot;</span>, <span class="st">&quot;consult&quot;</span>, <span class="st">&quot;hobby&quot;</span>, <span class="st">&quot;essential&quot;</span>)</a>
<a class="sourceLine" id="cb17-6" data-line-number="6">classification &lt;-<span class="st"> </span><span class="kw">factor</span>(</a>
<a class="sourceLine" id="cb17-7" data-line-number="7">    <span class="kw">c</span>(<span class="st">&quot;connect&quot;</span>, <span class="st">&quot;essential&quot;</span>, <span class="st">&quot;connect&quot;</span>, <span class="st">&quot;consult&quot;</span>, <span class="st">&quot;exercise&quot;</span>),</a>
<a class="sourceLine" id="cb17-8" data-line-number="8">    <span class="dt">levels =</span> levels</a>
<a class="sourceLine" id="cb17-9" data-line-number="9">)</a>
<a class="sourceLine" id="cb17-10" data-line-number="10"></a>
<a class="sourceLine" id="cb17-11" data-line-number="11">dates &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;04-14-2020&quot;</span>, <span class="kw">length</span>(activity))</a>
<a class="sourceLine" id="cb17-12" data-line-number="12">date &lt;-<span class="st"> </span><span class="kw">as.Date</span>(dates, <span class="dt">format =</span> <span class="st">&quot;%m-%d-%Y&quot;</span>)</a></code></pre></div>
<p>Each of these vectors is the same length, and are related to one another in a specific way – the first element of <code>activity</code>, ‘check e-mail’, is related to the first element of <code>minutes</code>, ‘20’, and to <code>is_work</code>, etc.</p>
<p>Use <code>data.frame()</code> to construct an object containing each of these vectors</p>
<ul>
<li><p>Each argument to <code>data.frame()</code> is a vector representing a column</p></li>
<li><p>The <code>stringsAsFactors = FALSE</code> argument says that character vectors should NOT be automatically coerced to factors</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">activities &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb18-2" data-line-number="2">    activity, minutes, is_work, classification, date,</a>
<a class="sourceLine" id="cb18-3" data-line-number="3">    <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb18-4" data-line-number="4">)</a>
<a class="sourceLine" id="cb18-5" data-line-number="5">activities</a>
<a class="sourceLine" id="cb18-6" data-line-number="6"><span class="co">##          activity minutes is_work classification       date</span></a>
<a class="sourceLine" id="cb18-7" data-line-number="7"><span class="co">## 1    check e-mail      20    TRUE        connect 2020-04-14</span></a>
<a class="sourceLine" id="cb18-8" data-line-number="8"><span class="co">## 2       breakfast      30   FALSE      essential 2020-04-14</span></a>
<a class="sourceLine" id="cb18-9" data-line-number="9"><span class="co">## 3 conference call      60    TRUE        connect 2020-04-14</span></a>
<a class="sourceLine" id="cb18-10" data-line-number="10"><span class="co">## 4         webinar      60    TRUE        consult 2020-04-14</span></a>
<a class="sourceLine" id="cb18-11" data-line-number="11"><span class="co">## 5            walk      60   FALSE       exercise 2020-04-14</span></a></code></pre></div></li>
<li><p>We can query the object we’ve created for its <code>class()</code>, <code>dim()</code>ensions, take a look at the <code>head()</code> or <code>tail()</code> of the object, etc. <code>names()</code> returns the column names.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw">class</span>(activities)</a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="co">## [1] &quot;data.frame&quot;</span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="kw">dim</span>(activities)     <span class="co"># number of rows and columns</span></a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="co">## [1] 5 5</span></a>
<a class="sourceLine" id="cb19-5" data-line-number="5"><span class="kw">head</span>(activities, <span class="dv">3</span>) <span class="co"># first three rows</span></a>
<a class="sourceLine" id="cb19-6" data-line-number="6"><span class="co">##          activity minutes is_work classification       date</span></a>
<a class="sourceLine" id="cb19-7" data-line-number="7"><span class="co">## 1    check e-mail      20    TRUE        connect 2020-04-14</span></a>
<a class="sourceLine" id="cb19-8" data-line-number="8"><span class="co">## 2       breakfast      30   FALSE      essential 2020-04-14</span></a>
<a class="sourceLine" id="cb19-9" data-line-number="9"><span class="co">## 3 conference call      60    TRUE        connect 2020-04-14</span></a>
<a class="sourceLine" id="cb19-10" data-line-number="10"><span class="kw">names</span>(activities)</a>
<a class="sourceLine" id="cb19-11" data-line-number="11"><span class="co">## [1] &quot;activity&quot;       &quot;minutes&quot;        &quot;is_work&quot;        &quot;classification&quot;</span></a>
<a class="sourceLine" id="cb19-12" data-line-number="12"><span class="co">## [5] &quot;date&quot;</span></a></code></pre></div></li>
</ul>
</div>
<div id="column-selection" class="section level3 unnumbered">
<h3>Column selection</h3>
<p>Use <code>[</code> to select rows and columns</p>
<ul>
<li><p><code>activities</code> is a two-dimensional object</p></li>
<li><p>Subset the data to contain the first and third rows and the first and fourth columns</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">activities[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)]</a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="co">##          activity classification</span></a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="co">## 1    check e-mail        connect</span></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="co">## 3 conference call        connect</span></a></code></pre></div></li>
<li><p>Subset columns by name</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">activities[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="kw">c</span>(<span class="st">&quot;activity&quot;</span>, <span class="st">&quot;is_work&quot;</span>)]</a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="co">##          activity is_work</span></a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="co">## 1    check e-mail    TRUE</span></a>
<a class="sourceLine" id="cb21-4" data-line-number="4"><span class="co">## 3 conference call    TRUE</span></a></code></pre></div></li>
<li><p>Subset only by row or only by column by omiting the subscript index for that dimension</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">activities[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), ]                  <span class="co"># all columns for rows 1 and 3</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2"><span class="co">##          activity minutes is_work classification       date</span></a>
<a class="sourceLine" id="cb22-3" data-line-number="3"><span class="co">## 1    check e-mail      20    TRUE        connect 2020-04-14</span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4"><span class="co">## 3 conference call      60    TRUE        connect 2020-04-14</span></a>
<a class="sourceLine" id="cb22-5" data-line-number="5">activities[, <span class="kw">c</span>(<span class="st">&quot;activity&quot;</span>, <span class="st">&quot;minutes&quot;</span>)] <span class="co"># all rows for columns 1 and 2</span></a>
<a class="sourceLine" id="cb22-6" data-line-number="6"><span class="co">##          activity minutes</span></a>
<a class="sourceLine" id="cb22-7" data-line-number="7"><span class="co">## 1    check e-mail      20</span></a>
<a class="sourceLine" id="cb22-8" data-line-number="8"><span class="co">## 2       breakfast      30</span></a>
<a class="sourceLine" id="cb22-9" data-line-number="9"><span class="co">## 3 conference call      60</span></a>
<a class="sourceLine" id="cb22-10" data-line-number="10"><span class="co">## 4         webinar      60</span></a>
<a class="sourceLine" id="cb22-11" data-line-number="11"><span class="co">## 5            walk      60</span></a></code></pre></div></li>
<li><p>Be careful when selecting a single column!</p>
<ul>
<li><p>By default, <em>R</em> returns a <em>vector</em></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">activities[, <span class="st">&quot;classification&quot;</span>]</a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="co">## [1] connect   essential connect   consult   exercise </span></a>
<a class="sourceLine" id="cb23-3" data-line-number="3"><span class="co">## Levels: connect exercise consult hobby essential</span></a></code></pre></div></li>
<li><p>Use <code>drop = FALSE</code> to return a <code>data.frame</code></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1">activities[, <span class="st">&quot;classification&quot;</span>, drop =<span class="st"> </span><span class="ot">FALSE</span>]</a>
<a class="sourceLine" id="cb24-2" data-line-number="2"><span class="co">##   classification</span></a>
<a class="sourceLine" id="cb24-3" data-line-number="3"><span class="co">## 1        connect</span></a>
<a class="sourceLine" id="cb24-4" data-line-number="4"><span class="co">## 2      essential</span></a>
<a class="sourceLine" id="cb24-5" data-line-number="5"><span class="co">## 3        connect</span></a>
<a class="sourceLine" id="cb24-6" data-line-number="6"><span class="co">## 4        consult</span></a>
<a class="sourceLine" id="cb24-7" data-line-number="7"><span class="co">## 5       exercise</span></a></code></pre></div></li>
</ul></li>
</ul>
<p>Use <code>$</code> or <code>[[</code> to select a column</p>
<ul>
<li><p>Selection of individual columns as vectors is easy</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">activities<span class="op">$</span>classification</a>
<a class="sourceLine" id="cb25-2" data-line-number="2"><span class="co">## [1] connect   essential connect   consult   exercise </span></a>
<a class="sourceLine" id="cb25-3" data-line-number="3"><span class="co">## Levels: connect exercise consult hobby essential</span></a></code></pre></div></li>
<li><p>An alternative, often used in scripts, is to use <code>[[</code>, which requires the name of a variable provided as a character vector</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1">activities[[<span class="st">&quot;classification&quot;</span>]]</a>
<a class="sourceLine" id="cb26-2" data-line-number="2"><span class="co">## [1] connect   essential connect   consult   exercise </span></a>
<a class="sourceLine" id="cb26-3" data-line-number="3"><span class="co">## Levels: connect exercise consult hobby essential</span></a>
<a class="sourceLine" id="cb26-4" data-line-number="4"></a>
<a class="sourceLine" id="cb26-5" data-line-number="5">colname &lt;-<span class="st"> &quot;classification&quot;</span></a>
<a class="sourceLine" id="cb26-6" data-line-number="6">activities[[colname]]</a>
<a class="sourceLine" id="cb26-7" data-line-number="7"><span class="co">## [1] connect   essential connect   consult   exercise </span></a>
<a class="sourceLine" id="cb26-8" data-line-number="8"><span class="co">## Levels: connect exercise consult hobby essential</span></a></code></pre></div></li>
</ul>
<p>Column selection and subsetting are often combined, e.g., to create a <code>data.frame</code> of work-related activities, or work-related activities lasting 60 minutes or longer</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">work_related_activities &lt;-<span class="st"> </span>activities[ activities<span class="op">$</span>is_work <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>, ]</a>
<a class="sourceLine" id="cb27-2" data-line-number="2">work_related_activities</a>
<a class="sourceLine" id="cb27-3" data-line-number="3"><span class="co">##          activity minutes is_work classification       date</span></a>
<a class="sourceLine" id="cb27-4" data-line-number="4"><span class="co">## 1    check e-mail      20    TRUE        connect 2020-04-14</span></a>
<a class="sourceLine" id="cb27-5" data-line-number="5"><span class="co">## 3 conference call      60    TRUE        connect 2020-04-14</span></a>
<a class="sourceLine" id="cb27-6" data-line-number="6"><span class="co">## 4         webinar      60    TRUE        consult 2020-04-14</span></a>
<a class="sourceLine" id="cb27-7" data-line-number="7"></a>
<a class="sourceLine" id="cb27-8" data-line-number="8">row_idx &lt;-<span class="st"> </span>activities<span class="op">$</span>is_work <span class="op">&amp;</span><span class="st"> </span>(activities<span class="op">$</span>minutes <span class="op">&gt;=</span><span class="st"> </span><span class="dv">60</span>)</a>
<a class="sourceLine" id="cb27-9" data-line-number="9">activities[row_idx,]</a>
<a class="sourceLine" id="cb27-10" data-line-number="10"><span class="co">##          activity minutes is_work classification       date</span></a>
<a class="sourceLine" id="cb27-11" data-line-number="11"><span class="co">## 3 conference call      60    TRUE        connect 2020-04-14</span></a>
<a class="sourceLine" id="cb27-12" data-line-number="12"><span class="co">## 4         webinar      60    TRUE        consult 2020-04-14</span></a></code></pre></div>
</div>
<div id="adding-or-updating-columns" class="section level3 unnumbered">
<h3>Adding or updating columns</h3>
<p>Use <code>$</code> or <code>[</code> or <code>[[</code> to add a new column,</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1">activities<span class="op">$</span>is_long_work &lt;-<span class="st"> </span>activities<span class="op">$</span>is_work <span class="op">&amp;</span><span class="st"> </span>(activities<span class="op">$</span>minutes <span class="op">&gt;=</span><span class="st"> </span><span class="dv">60</span>)</a>
<a class="sourceLine" id="cb28-2" data-line-number="2">activities</a>
<a class="sourceLine" id="cb28-3" data-line-number="3"><span class="co">##          activity minutes is_work classification       date is_long_work</span></a>
<a class="sourceLine" id="cb28-4" data-line-number="4"><span class="co">## 1    check e-mail      20    TRUE        connect 2020-04-14        FALSE</span></a>
<a class="sourceLine" id="cb28-5" data-line-number="5"><span class="co">## 2       breakfast      30   FALSE      essential 2020-04-14        FALSE</span></a>
<a class="sourceLine" id="cb28-6" data-line-number="6"><span class="co">## 3 conference call      60    TRUE        connect 2020-04-14         TRUE</span></a>
<a class="sourceLine" id="cb28-7" data-line-number="7"><span class="co">## 4         webinar      60    TRUE        consult 2020-04-14         TRUE</span></a>
<a class="sourceLine" id="cb28-8" data-line-number="8"><span class="co">## 5            walk      60   FALSE       exercise 2020-04-14        FALSE</span></a>
<a class="sourceLine" id="cb28-9" data-line-number="9"></a>
<a class="sourceLine" id="cb28-10" data-line-number="10"><span class="co">## ...another way of doing the same thing</span></a>
<a class="sourceLine" id="cb28-11" data-line-number="11">activities[[<span class="st">&quot;is_long_work&quot;</span>]] &lt;-<span class="st"> </span>activities<span class="op">$</span>is_work <span class="op">&amp;</span><span class="st"> </span>(activities<span class="op">$</span>minutes <span class="op">&gt;=</span><span class="st"> </span><span class="dv">60</span>)</a>
<a class="sourceLine" id="cb28-12" data-line-number="12"></a>
<a class="sourceLine" id="cb28-13" data-line-number="13"><span class="co">## ...and another way</span></a>
<a class="sourceLine" id="cb28-14" data-line-number="14">activities[,<span class="st">&quot;is_long_work&quot;</span>] &lt;-<span class="st"> </span>activities<span class="op">$</span>is_work <span class="op">&amp;</span><span class="st"> </span>(activities<span class="op">$</span>minutes <span class="op">&gt;=</span><span class="st"> </span><span class="dv">60</span>)</a></code></pre></div>
<p>Columns can be updated in the same way</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1">activities<span class="op">$</span>activity &lt;-<span class="st"> </span><span class="kw">toupper</span>(activities<span class="op">$</span>activity)</a>
<a class="sourceLine" id="cb29-2" data-line-number="2">activities</a>
<a class="sourceLine" id="cb29-3" data-line-number="3"><span class="co">##          activity minutes is_work classification       date is_long_work</span></a>
<a class="sourceLine" id="cb29-4" data-line-number="4"><span class="co">## 1    CHECK E-MAIL      20    TRUE        connect 2020-04-14        FALSE</span></a>
<a class="sourceLine" id="cb29-5" data-line-number="5"><span class="co">## 2       BREAKFAST      30   FALSE      essential 2020-04-14        FALSE</span></a>
<a class="sourceLine" id="cb29-6" data-line-number="6"><span class="co">## 3 CONFERENCE CALL      60    TRUE        connect 2020-04-14         TRUE</span></a>
<a class="sourceLine" id="cb29-7" data-line-number="7"><span class="co">## 4         WEBINAR      60    TRUE        consult 2020-04-14         TRUE</span></a>
<a class="sourceLine" id="cb29-8" data-line-number="8"><span class="co">## 5            WALK      60   FALSE       exercise 2020-04-14        FALSE</span></a></code></pre></div>
</div>
<div id="reading-and-writing" class="section level3 unnumbered">
<h3>Reading and writing</h3>
<p>Create a file path to store a ‘csv’ file. From day 7, the path could be temporary, chosen interactively, a relative path, or an absolute path</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="co">## could be any of these...</span></a>
<a class="sourceLine" id="cb30-2" data-line-number="2"><span class="co">##</span></a>
<a class="sourceLine" id="cb30-3" data-line-number="3"><span class="co">## interactive_file_path &lt;- file.choose(new = TRUE)</span></a>
<a class="sourceLine" id="cb30-4" data-line-number="4"><span class="co">## getwd()</span></a>
<a class="sourceLine" id="cb30-5" data-line-number="5"><span class="co">## relative_file_path &lt;- &quot;my_activity.rds&quot;</span></a>
<a class="sourceLine" id="cb30-6" data-line-number="6"><span class="co">## absolute_file_path_on_macOS &lt;- &quot;/Users/ma38727/my_activity.rda&quot;</span></a>
<a class="sourceLine" id="cb30-7" data-line-number="7"><span class="co">##</span></a>
<a class="sourceLine" id="cb30-8" data-line-number="8"><span class="co">## ... but we&#39;ll use</span></a>
<a class="sourceLine" id="cb30-9" data-line-number="9">temporary_file_path &lt;-<span class="st"> </span><span class="kw">tempfile</span>(<span class="dt">fileext =</span> <span class="st">&quot;.csv&quot;</span>)</a></code></pre></div>
<p>Use <code>write.csv()</code> to save the data.frame to disk as a plain text file in ‘csv’ (comma-separated value) format. The <code>row.names = FALSE</code> argument means that the row indexes are not saved to the file (row names are created when data is read in using <code>read.csv()</code>).</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="kw">write.csv</span>(activities, temporary_file_path, <span class="dt">row.names =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p>If you wish, use RStudio File -&gt; Open File to navigate to the location where you saved the file, and open it. You could also open the file in Excel or other spreadsheet. Conversely, you can take an Excel sheet and export it as a csv file for reading into <em>R</em>.</p>
<p>Use <code>read.csv()</code> to import a plain text file formatted as csv</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1">imported_activities &lt;-<span class="st"> </span><span class="kw">read.csv</span>(temporary_file_path, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb32-2" data-line-number="2">imported_activities</a>
<a class="sourceLine" id="cb32-3" data-line-number="3"><span class="co">##          activity minutes is_work classification       date is_long_work</span></a>
<a class="sourceLine" id="cb32-4" data-line-number="4"><span class="co">## 1    CHECK E-MAIL      20    TRUE        connect 2020-04-14        FALSE</span></a>
<a class="sourceLine" id="cb32-5" data-line-number="5"><span class="co">## 2       BREAKFAST      30   FALSE      essential 2020-04-14        FALSE</span></a>
<a class="sourceLine" id="cb32-6" data-line-number="6"><span class="co">## 3 CONFERENCE CALL      60    TRUE        connect 2020-04-14         TRUE</span></a>
<a class="sourceLine" id="cb32-7" data-line-number="7"><span class="co">## 4         WEBINAR      60    TRUE        consult 2020-04-14         TRUE</span></a>
<a class="sourceLine" id="cb32-8" data-line-number="8"><span class="co">## 5            WALK      60   FALSE       exercise 2020-04-14        FALSE</span></a></code></pre></div>
<p>Note that some information has not survived the round-trip – the <code>classification</code> and <code>date</code> columns are plain character vectors.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="kw">class</span>(imported_activities<span class="op">$</span>classification)</a>
<a class="sourceLine" id="cb33-2" data-line-number="2"><span class="co">## [1] &quot;character&quot;</span></a>
<a class="sourceLine" id="cb33-3" data-line-number="3"><span class="kw">class</span>(imported_activities<span class="op">$</span>date)</a>
<a class="sourceLine" id="cb33-4" data-line-number="4"><span class="co">## [1] &quot;character&quot;</span></a></code></pre></div>
<p>Update these to be a <code>factor()</code> with specific levels, and a <code>Date</code>.
`</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1">levels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;connect&quot;</span>, <span class="st">&quot;exercise&quot;</span>, <span class="st">&quot;consult&quot;</span>, <span class="st">&quot;hobby&quot;</span>, <span class="st">&quot;essential&quot;</span>)</a>
<a class="sourceLine" id="cb34-2" data-line-number="2">imported_activities<span class="op">$</span>classification &lt;-<span class="st"> </span><span class="kw">factor</span>(</a>
<a class="sourceLine" id="cb34-3" data-line-number="3">    imported_activities<span class="op">$</span>classification,</a>
<a class="sourceLine" id="cb34-4" data-line-number="4">    <span class="dt">levels =</span> levels</a>
<a class="sourceLine" id="cb34-5" data-line-number="5">)</a>
<a class="sourceLine" id="cb34-6" data-line-number="6"></a>
<a class="sourceLine" id="cb34-7" data-line-number="7">imported_activities<span class="op">$</span>date &lt;-<span class="st"> </span><span class="kw">as.Date</span>(imported_activities<span class="op">$</span>date, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>)</a>
<a class="sourceLine" id="cb34-8" data-line-number="8"></a>
<a class="sourceLine" id="cb34-9" data-line-number="9">imported_activities</a>
<a class="sourceLine" id="cb34-10" data-line-number="10"><span class="co">##          activity minutes is_work classification       date is_long_work</span></a>
<a class="sourceLine" id="cb34-11" data-line-number="11"><span class="co">## 1    CHECK E-MAIL      20    TRUE        connect 2020-04-14        FALSE</span></a>
<a class="sourceLine" id="cb34-12" data-line-number="12"><span class="co">## 2       BREAKFAST      30   FALSE      essential 2020-04-14        FALSE</span></a>
<a class="sourceLine" id="cb34-13" data-line-number="13"><span class="co">## 3 CONFERENCE CALL      60    TRUE        connect 2020-04-14         TRUE</span></a>
<a class="sourceLine" id="cb34-14" data-line-number="14"><span class="co">## 4         WEBINAR      60    TRUE        consult 2020-04-14         TRUE</span></a>
<a class="sourceLine" id="cb34-15" data-line-number="15"><span class="co">## 5            WALK      60   FALSE       exercise 2020-04-14        FALSE</span></a></code></pre></div>
</div>
<div id="reading-from-a-remote-file" class="section level3 unnumbered">
<h3>Reading from a remote file (!)</h3>
<ul>
<li><p>Visit the New York Times <a href="https://raw.githubusercontent.com/nytimes/covid-19-data/master/us-counties.csv">csv file</a> daily tally of COVID-19 cases in all US counties.</p></li>
<li><p>Read the data into an <em>R</em> <code>data.frame</code></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1">url &lt;-</a>
<a class="sourceLine" id="cb35-2" data-line-number="2"><span class="st">  &quot;https://raw.githubusercontent.com/nytimes/covid-19-data/master/us-counties.csv&quot;</span></a>
<a class="sourceLine" id="cb35-3" data-line-number="3">us &lt;-<span class="st"> </span><span class="kw">read.csv</span>(url, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a></code></pre></div></li>
<li><p>Explore the data</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="kw">class</span>(us)</a>
<a class="sourceLine" id="cb36-2" data-line-number="2"><span class="co">## [1] &quot;data.frame&quot;</span></a>
<a class="sourceLine" id="cb36-3" data-line-number="3"><span class="kw">dim</span>(us)</a>
<a class="sourceLine" id="cb36-4" data-line-number="4"><span class="co">## [1] 72988     6</span></a>
<a class="sourceLine" id="cb36-5" data-line-number="5"><span class="kw">head</span>(us)</a>
<a class="sourceLine" id="cb36-6" data-line-number="6"><span class="co">##         date    county      state  fips cases deaths</span></a>
<a class="sourceLine" id="cb36-7" data-line-number="7"><span class="co">## 1 2020-01-21 Snohomish Washington 53061     1      0</span></a>
<a class="sourceLine" id="cb36-8" data-line-number="8"><span class="co">## 2 2020-01-22 Snohomish Washington 53061     1      0</span></a>
<a class="sourceLine" id="cb36-9" data-line-number="9"><span class="co">## 3 2020-01-23 Snohomish Washington 53061     1      0</span></a>
<a class="sourceLine" id="cb36-10" data-line-number="10"><span class="co">## 4 2020-01-24      Cook   Illinois 17031     1      0</span></a>
<a class="sourceLine" id="cb36-11" data-line-number="11"><span class="co">## 5 2020-01-24 Snohomish Washington 53061     1      0</span></a>
<a class="sourceLine" id="cb36-12" data-line-number="12"><span class="co">## 6 2020-01-25    Orange California  6059     1      0</span></a></code></pre></div></li>
<li><p>Subset the data to only New York state or Erie county</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1">ny_state &lt;-<span class="st"> </span>us[us<span class="op">$</span>state <span class="op">==</span><span class="st"> &quot;New York&quot;</span>,]</a>
<a class="sourceLine" id="cb37-2" data-line-number="2"><span class="kw">dim</span>(ny_state)</a>
<a class="sourceLine" id="cb37-3" data-line-number="3"><span class="co">## [1] 1956    6</span></a>
<a class="sourceLine" id="cb37-4" data-line-number="4"></a>
<a class="sourceLine" id="cb37-5" data-line-number="5">erie &lt;-<span class="st"> </span>us[(us<span class="op">$</span>state <span class="op">==</span><span class="st"> &quot;New York&quot;</span>) <span class="op">&amp;</span><span class="st"> </span>(us<span class="op">$</span>county <span class="op">==</span><span class="st"> &quot;Erie&quot;</span>), ]</a>
<a class="sourceLine" id="cb37-6" data-line-number="6">erie</a>
<a class="sourceLine" id="cb37-7" data-line-number="7"><span class="co">##             date county    state  fips cases deaths</span></a>
<a class="sourceLine" id="cb37-8" data-line-number="8"><span class="co">## 2569  2020-03-15   Erie New York 36029     3      0</span></a>
<a class="sourceLine" id="cb37-9" data-line-number="9"><span class="co">## 3028  2020-03-16   Erie New York 36029     6      0</span></a>
<a class="sourceLine" id="cb37-10" data-line-number="10"><span class="co">## 3544  2020-03-17   Erie New York 36029     7      0</span></a>
<a class="sourceLine" id="cb37-11" data-line-number="11"><span class="co">## 4141  2020-03-18   Erie New York 36029     7      0</span></a>
<a class="sourceLine" id="cb37-12" data-line-number="12"><span class="co">## 4870  2020-03-19   Erie New York 36029    28      0</span></a>
<a class="sourceLine" id="cb37-13" data-line-number="13"><span class="co">## 5717  2020-03-20   Erie New York 36029    31      0</span></a>
<a class="sourceLine" id="cb37-14" data-line-number="14"><span class="co">## 6711  2020-03-21   Erie New York 36029    38      0</span></a>
<a class="sourceLine" id="cb37-15" data-line-number="15"><span class="co">## 7805  2020-03-22   Erie New York 36029    54      0</span></a>
<a class="sourceLine" id="cb37-16" data-line-number="16"><span class="co">## 9003  2020-03-23   Erie New York 36029    87      0</span></a>
<a class="sourceLine" id="cb37-17" data-line-number="17"><span class="co">## 10314 2020-03-24   Erie New York 36029   107      0</span></a>
<a class="sourceLine" id="cb37-18" data-line-number="18"><span class="co">## 11754 2020-03-25   Erie New York 36029   122      0</span></a>
<a class="sourceLine" id="cb37-19" data-line-number="19"><span class="co">## 13367 2020-03-26   Erie New York 36029   134      2</span></a>
<a class="sourceLine" id="cb37-20" data-line-number="20"><span class="co">## 15111 2020-03-27   Erie New York 36029   219      6</span></a>
<a class="sourceLine" id="cb37-21" data-line-number="21"><span class="co">## 16951 2020-03-28   Erie New York 36029   354      6</span></a>
<a class="sourceLine" id="cb37-22" data-line-number="22"><span class="co">## 18888 2020-03-29   Erie New York 36029   380      6</span></a>
<a class="sourceLine" id="cb37-23" data-line-number="23"><span class="co">## 20938 2020-03-30   Erie New York 36029   443      8</span></a>
<a class="sourceLine" id="cb37-24" data-line-number="24"><span class="co">## 23079 2020-03-31   Erie New York 36029   438      8</span></a>
<a class="sourceLine" id="cb37-25" data-line-number="25"><span class="co">## 25283 2020-04-01   Erie New York 36029   553     12</span></a>
<a class="sourceLine" id="cb37-26" data-line-number="26"><span class="co">## 27544 2020-04-02   Erie New York 36029   734     19</span></a>
<a class="sourceLine" id="cb37-27" data-line-number="27"><span class="co">## 29866 2020-04-03   Erie New York 36029   802     22</span></a>
<a class="sourceLine" id="cb37-28" data-line-number="28"><span class="co">## 32254 2020-04-04   Erie New York 36029   945     26</span></a>
<a class="sourceLine" id="cb37-29" data-line-number="29"><span class="co">## 34687 2020-04-05   Erie New York 36029  1059     27</span></a>
<a class="sourceLine" id="cb37-30" data-line-number="30"><span class="co">## 37160 2020-04-06   Erie New York 36029  1163     30</span></a>
<a class="sourceLine" id="cb37-31" data-line-number="31"><span class="co">## 39674 2020-04-07   Erie New York 36029  1163     36</span></a>
<a class="sourceLine" id="cb37-32" data-line-number="32"><span class="co">## 42227 2020-04-08   Erie New York 36029  1205     38</span></a>
<a class="sourceLine" id="cb37-33" data-line-number="33"><span class="co">## 44803 2020-04-09   Erie New York 36029  1362     46</span></a>
<a class="sourceLine" id="cb37-34" data-line-number="34"><span class="co">## 47417 2020-04-10   Erie New York 36029  1409     58</span></a>
<a class="sourceLine" id="cb37-35" data-line-number="35"><span class="co">## 50071 2020-04-11   Erie New York 36029  1472     62</span></a>
<a class="sourceLine" id="cb37-36" data-line-number="36"><span class="co">## 52744 2020-04-12   Erie New York 36029  1571     75</span></a>
<a class="sourceLine" id="cb37-37" data-line-number="37"><span class="co">## 55428 2020-04-13   Erie New York 36029  1624     86</span></a>
<a class="sourceLine" id="cb37-38" data-line-number="38"><span class="co">## 58128 2020-04-14   Erie New York 36029  1668     99</span></a>
<a class="sourceLine" id="cb37-39" data-line-number="39"><span class="co">## 60844 2020-04-15   Erie New York 36029  1751    110</span></a>
<a class="sourceLine" id="cb37-40" data-line-number="40"><span class="co">## 63572 2020-04-16   Erie New York 36029  1850    115</span></a>
<a class="sourceLine" id="cb37-41" data-line-number="41"><span class="co">## 66316 2020-04-17   Erie New York 36029  1929    115</span></a>
<a class="sourceLine" id="cb37-42" data-line-number="42"><span class="co">## 69074 2020-04-18   Erie New York 36029  1997    115</span></a>
<a class="sourceLine" id="cb37-43" data-line-number="43"><span class="co">## 71842 2020-04-19   Erie New York 36029  2070    146</span></a></code></pre></div></li>
</ul>
</div>
</div>
<div id="day-10-subset-with-and-within" class="section level2">
<h2><span class="header-section-number">2.3</span> Day 10: <code>subset()</code>, <code>with()</code>, and <code>within()</code></h2>
<div id="subset" class="section level3 unnumbered">
<h3><code>subset()</code></h3>
<p><code>subset()</code>ing a <code>data.frame</code></p>
<ul>
<li><p>Read the New York Times csv file summarizing COVID cases in the US.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1">url &lt;-</a>
<a class="sourceLine" id="cb38-2" data-line-number="2"><span class="st">  &quot;https://raw.githubusercontent.com/nytimes/covid-19-data/master/us-counties.csv&quot;</span></a>
<a class="sourceLine" id="cb38-3" data-line-number="3">us &lt;-<span class="st"> </span><span class="kw">read.csv</span>(url, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a></code></pre></div></li>
<li><p>Create subsets, e.g., to include only New York state, or only Erie county</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1">ny_state &lt;-<span class="st"> </span><span class="kw">subset</span>(us, state <span class="op">==</span><span class="st"> &quot;New York&quot;</span>)</a>
<a class="sourceLine" id="cb39-2" data-line-number="2"><span class="kw">dim</span>(ny_state)</a>
<a class="sourceLine" id="cb39-3" data-line-number="3"><span class="co">## [1] 1956    6</span></a>
<a class="sourceLine" id="cb39-4" data-line-number="4"><span class="kw">tail</span>(ny_state)</a>
<a class="sourceLine" id="cb39-5" data-line-number="5"><span class="co">##             date      county    state  fips cases deaths</span></a>
<a class="sourceLine" id="cb39-6" data-line-number="6"><span class="co">## 71881 2020-04-19      Warren New York 36113    96      6</span></a>
<a class="sourceLine" id="cb39-7" data-line-number="7"><span class="co">## 71882 2020-04-19  Washington New York 36115    63      0</span></a>
<a class="sourceLine" id="cb39-8" data-line-number="8"><span class="co">## 71883 2020-04-19       Wayne New York 36117    50      0</span></a>
<a class="sourceLine" id="cb39-9" data-line-number="9"><span class="co">## 71884 2020-04-19 Westchester New York 36119 23803    831</span></a>
<a class="sourceLine" id="cb39-10" data-line-number="10"><span class="co">## 71885 2020-04-19     Wyoming New York 36121    36      3</span></a>
<a class="sourceLine" id="cb39-11" data-line-number="11"><span class="co">## 71886 2020-04-19       Yates New York 36123     9      0</span></a>
<a class="sourceLine" id="cb39-12" data-line-number="12"></a>
<a class="sourceLine" id="cb39-13" data-line-number="13">erie &lt;-<span class="st"> </span><span class="kw">subset</span>(us, (state <span class="op">==</span><span class="st"> &quot;New York&quot;</span>) <span class="op">&amp;</span><span class="st"> </span>county <span class="op">==</span><span class="st"> &quot;Erie&quot;</span>)</a>
<a class="sourceLine" id="cb39-14" data-line-number="14"><span class="kw">dim</span>(erie)</a>
<a class="sourceLine" id="cb39-15" data-line-number="15"><span class="co">## [1] 36  6</span></a>
<a class="sourceLine" id="cb39-16" data-line-number="16"><span class="kw">tail</span>(erie)</a>
<a class="sourceLine" id="cb39-17" data-line-number="17"><span class="co">##             date county    state  fips cases deaths</span></a>
<a class="sourceLine" id="cb39-18" data-line-number="18"><span class="co">## 58128 2020-04-14   Erie New York 36029  1668     99</span></a>
<a class="sourceLine" id="cb39-19" data-line-number="19"><span class="co">## 60844 2020-04-15   Erie New York 36029  1751    110</span></a>
<a class="sourceLine" id="cb39-20" data-line-number="20"><span class="co">## 63572 2020-04-16   Erie New York 36029  1850    115</span></a>
<a class="sourceLine" id="cb39-21" data-line-number="21"><span class="co">## 66316 2020-04-17   Erie New York 36029  1929    115</span></a>
<a class="sourceLine" id="cb39-22" data-line-number="22"><span class="co">## 69074 2020-04-18   Erie New York 36029  1997    115</span></a>
<a class="sourceLine" id="cb39-23" data-line-number="23"><span class="co">## 71842 2020-04-19   Erie New York 36029  2070    146</span></a></code></pre></div></li>
</ul>
</div>
<div id="with" class="section level3 unnumbered">
<h3><code>with()</code></h3>
<p>Use <code>with()</code> to simplify column references</p>
<ul>
<li><p>Goal: calculate maximum number of cases in the Erie county data subset</p></li>
<li><p>First argument: a <code>data.frame</code> containing data to be manipulated – <code>erie</code></p></li>
<li><p>Second argument: an <em>expression</em> to be evaluated, usually referencing columns in the data set – <code>max(cases)</code></p>
<ul>
<li><p>E.g., Calculate the maximum number of cases in the <code>erie</code> subset</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="kw">with</span>(erie, <span class="kw">max</span>(cases))</a>
<a class="sourceLine" id="cb40-2" data-line-number="2"><span class="co">## [1] 2070</span></a></code></pre></div></li>
</ul></li>
</ul>
<p>Second argument can be more complicated, using <code>{}</code> to enclose several lines.</p>
<ul>
<li><p>E.g., Calculate the number of new cases, and then reports the average number of new cases per day. We will use <code>diff()</code></p>
<ul>
<li><p><code>diff()</code> calculates the difference between successive values of a vector</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">8</span>)</a>
<a class="sourceLine" id="cb41-2" data-line-number="2"><span class="kw">diff</span>(x)</a>
<a class="sourceLine" id="cb41-3" data-line-number="3"><span class="co">## [1] 0 1 1 2 3</span></a></code></pre></div></li>
<li><p>The length of <code>diff(x)</code> is one less than the length of <code>x</code></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb42-2" data-line-number="2"><span class="co">## [1] 6</span></a>
<a class="sourceLine" id="cb42-3" data-line-number="3"><span class="kw">length</span>(<span class="kw">diff</span>(x))</a>
<a class="sourceLine" id="cb42-4" data-line-number="4"><span class="co">## [1] 5</span></a></code></pre></div></li>
</ul></li>
<li><p><code>new_cases</code> is the <code>diff()</code> of successive values of <code>cases</code>, with an implicit initial value equal to 0.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="kw">with</span>(erie, {</a>
<a class="sourceLine" id="cb43-2" data-line-number="2">    new_cases &lt;-<span class="st"> </span><span class="kw">diff</span>(<span class="kw">c</span>(<span class="dv">0</span>, cases))</a>
<a class="sourceLine" id="cb43-3" data-line-number="3">    <span class="kw">mean</span>(new_cases)</a>
<a class="sourceLine" id="cb43-4" data-line-number="4">})</a>
<a class="sourceLine" id="cb43-5" data-line-number="5"><span class="co">## [1] 57.5</span></a></code></pre></div></li>
</ul>
</div>
<div id="within" class="section level3 unnumbered">
<h3><code>within()</code></h3>
<p>Adding and updating columns <code>within()</code> a <code>data.frame</code></p>
<ul>
<li><p>First argument: a <code>data.frame</code> containing data to be updated – <code>erie</code></p></li>
<li><p>Second argument: an expression of one or more variable assignments, the assignments create new columns in the <code>data.frame</code>.</p></li>
<li><p>Example: add a <code>new_cases</code> column</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1">erie_new_cases &lt;-<span class="st"> </span><span class="kw">within</span>(erie, {</a>
<a class="sourceLine" id="cb44-2" data-line-number="2">    new_cases &lt;-<span class="st"> </span><span class="kw">diff</span>(<span class="kw">c</span>(<span class="dv">0</span>, cases))</a>
<a class="sourceLine" id="cb44-3" data-line-number="3">})</a>
<a class="sourceLine" id="cb44-4" data-line-number="4"><span class="kw">head</span>(erie_new_cases)</a>
<a class="sourceLine" id="cb44-5" data-line-number="5"><span class="co">##            date county    state  fips cases deaths new_cases</span></a>
<a class="sourceLine" id="cb44-6" data-line-number="6"><span class="co">## 2569 2020-03-15   Erie New York 36029     3      0         3</span></a>
<a class="sourceLine" id="cb44-7" data-line-number="7"><span class="co">## 3028 2020-03-16   Erie New York 36029     6      0         3</span></a>
<a class="sourceLine" id="cb44-8" data-line-number="8"><span class="co">## 3544 2020-03-17   Erie New York 36029     7      0         1</span></a>
<a class="sourceLine" id="cb44-9" data-line-number="9"><span class="co">## 4141 2020-03-18   Erie New York 36029     7      0         0</span></a>
<a class="sourceLine" id="cb44-10" data-line-number="10"><span class="co">## 4870 2020-03-19   Erie New York 36029    28      0        21</span></a>
<a class="sourceLine" id="cb44-11" data-line-number="11"><span class="co">## 5717 2020-03-20   Erie New York 36029    31      0         3</span></a></code></pre></div></li>
</ul>
</div>
</div>
<div id="day-11-aggregate-and-an-initial-work-flow" class="section level2">
<h2><span class="header-section-number">2.4</span> Day 11: <code>aggregate()</code> and an initial work flow</h2>
<div id="aggregate-for-summarizing-columns-by-group" class="section level3 unnumbered">
<h3><code>aggregate()</code> for summarizing columns by group</h3>
<p>Goal: summarize maximum number of cases by county in New York state</p>
<p>Setup</p>
<ul>
<li><p>Read and subset the New York Times data to contain only New York state data</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1">url &lt;-<span class="st"> &quot;https://raw.githubusercontent.com/nytimes/covid-19-data/master/us-counties.csv&quot;</span></a>
<a class="sourceLine" id="cb45-2" data-line-number="2">us &lt;-<span class="st"> </span><span class="kw">read.csv</span>(url, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1">ny_state &lt;-<span class="st"> </span><span class="kw">subset</span>(us, state <span class="op">==</span><span class="st"> &quot;New York&quot;</span>)</a></code></pre></div></li>
</ul>
<p><code>aggregate()</code></p>
<ul>
<li><p>First argument: a <em>formula</em> – <code>cases ~ county</code></p>
<ul>
<li><p>Right-hand side: the variable to be used to subset (group) the data – <code>county</code></p></li>
<li><p>Left-hand side: the variable to be used in the aggregation function – <code>cases</code></p></li>
</ul></li>
<li><p>Second argument: source of data – <code>ny_state</code></p></li>
<li><p>Third argument: the function to be applied to each subset of data – <code>max</code></p></li>
<li><p>Maximum number of cases by county:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1">max_cases_by_county &lt;-<span class="st"> </span><span class="kw">aggregate</span>( cases <span class="op">~</span><span class="st"> </span>county, ny_state, max )</a></code></pre></div></li>
</ul>
<p>Exploring the data summary</p>
<ul>
<li><p>Subset to some interesting ‘counties’</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1"><span class="kw">head</span>(max_cases_by_county)</a>
<a class="sourceLine" id="cb48-2" data-line-number="2"><span class="co">##        county cases</span></a>
<a class="sourceLine" id="cb48-3" data-line-number="3"><span class="co">## 1      Albany   682</span></a>
<a class="sourceLine" id="cb48-4" data-line-number="4"><span class="co">## 2    Allegany    30</span></a>
<a class="sourceLine" id="cb48-5" data-line-number="5"><span class="co">## 3      Broome   192</span></a>
<a class="sourceLine" id="cb48-6" data-line-number="6"><span class="co">## 4 Cattaraugus    34</span></a>
<a class="sourceLine" id="cb48-7" data-line-number="7"><span class="co">## 5      Cayuga    36</span></a>
<a class="sourceLine" id="cb48-8" data-line-number="8"><span class="co">## 6  Chautauqua    25</span></a>
<a class="sourceLine" id="cb48-9" data-line-number="9"><span class="kw">subset</span>(</a>
<a class="sourceLine" id="cb48-10" data-line-number="10">    max_cases_by_county,</a>
<a class="sourceLine" id="cb48-11" data-line-number="11">    county <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;New York City&quot;</span>, <span class="st">&quot;Westchester&quot;</span>, <span class="st">&quot;Erie&quot;</span>)</a>
<a class="sourceLine" id="cb48-12" data-line-number="12">)</a>
<a class="sourceLine" id="cb48-13" data-line-number="13"><span class="co">##           county  cases</span></a>
<a class="sourceLine" id="cb48-14" data-line-number="14"><span class="co">## 14          Erie   2070</span></a>
<a class="sourceLine" id="cb48-15" data-line-number="15"><span class="co">## 29 New York City 134446</span></a>
<a class="sourceLine" id="cb48-16" data-line-number="16"><span class="co">## 57   Westchester  23803</span></a></code></pre></div></li>
</ul>
<p>Help: <code>?aggregate.formula</code></p>
</div>
<div id="an-initial-work-flow" class="section level3 unnumbered">
<h3>An initial work flow</h3>
<p>Data input</p>
<ul>
<li><p>From a remote location</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1">url &lt;-<span class="st"> &quot;https://raw.githubusercontent.com/nytimes/covid-19-data/master/us-counties.csv&quot;</span></a>
<a class="sourceLine" id="cb49-2" data-line-number="2">us &lt;-<span class="st"> </span><span class="kw">read.csv</span>(url, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1"><span class="kw">class</span>(us)</a>
<a class="sourceLine" id="cb50-2" data-line-number="2"><span class="co">## [1] &quot;data.frame&quot;</span></a>
<a class="sourceLine" id="cb50-3" data-line-number="3"><span class="kw">dim</span>(us)</a>
<a class="sourceLine" id="cb50-4" data-line-number="4"><span class="co">## [1] 72988     6</span></a>
<a class="sourceLine" id="cb50-5" data-line-number="5"><span class="kw">head</span>(us)</a>
<a class="sourceLine" id="cb50-6" data-line-number="6"><span class="co">##         date    county      state  fips cases deaths</span></a>
<a class="sourceLine" id="cb50-7" data-line-number="7"><span class="co">## 1 2020-01-21 Snohomish Washington 53061     1      0</span></a>
<a class="sourceLine" id="cb50-8" data-line-number="8"><span class="co">## 2 2020-01-22 Snohomish Washington 53061     1      0</span></a>
<a class="sourceLine" id="cb50-9" data-line-number="9"><span class="co">## 3 2020-01-23 Snohomish Washington 53061     1      0</span></a>
<a class="sourceLine" id="cb50-10" data-line-number="10"><span class="co">## 4 2020-01-24      Cook   Illinois 17031     1      0</span></a>
<a class="sourceLine" id="cb50-11" data-line-number="11"><span class="co">## 5 2020-01-24 Snohomish Washington 53061     1      0</span></a>
<a class="sourceLine" id="cb50-12" data-line-number="12"><span class="co">## 6 2020-01-25    Orange California  6059     1      0</span></a></code></pre></div></li>
</ul>
<p>Cleaning</p>
<ul>
<li><p><code>date</code> is a plain-old <code>character</code> vector, but should be a <code>Date</code>.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1"><span class="kw">class</span>(us<span class="op">$</span>date) <span class="co"># oops, should be &#39;Date&#39;</span></a>
<a class="sourceLine" id="cb51-2" data-line-number="2"><span class="co">## [1] &quot;character&quot;</span></a></code></pre></div></li>
<li><p>Update, method 1</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1">us<span class="op">$</span>date &lt;-<span class="st"> </span><span class="kw">as.Date</span>(us<span class="op">$</span>date, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>)</a>
<a class="sourceLine" id="cb52-2" data-line-number="2"><span class="kw">head</span>(us)</a>
<a class="sourceLine" id="cb52-3" data-line-number="3"><span class="co">##         date    county      state  fips cases deaths</span></a>
<a class="sourceLine" id="cb52-4" data-line-number="4"><span class="co">## 1 2020-01-21 Snohomish Washington 53061     1      0</span></a>
<a class="sourceLine" id="cb52-5" data-line-number="5"><span class="co">## 2 2020-01-22 Snohomish Washington 53061     1      0</span></a>
<a class="sourceLine" id="cb52-6" data-line-number="6"><span class="co">## 3 2020-01-23 Snohomish Washington 53061     1      0</span></a>
<a class="sourceLine" id="cb52-7" data-line-number="7"><span class="co">## 4 2020-01-24      Cook   Illinois 17031     1      0</span></a>
<a class="sourceLine" id="cb52-8" data-line-number="8"><span class="co">## 5 2020-01-24 Snohomish Washington 53061     1      0</span></a>
<a class="sourceLine" id="cb52-9" data-line-number="9"><span class="co">## 6 2020-01-25    Orange California  6059     1      0</span></a></code></pre></div></li>
<li><p>Update, method 2</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1">us &lt;-<span class="st"> </span><span class="kw">within</span>(us, {</a>
<a class="sourceLine" id="cb53-2" data-line-number="2">    date =<span class="st"> </span><span class="kw">as.Date</span>(date, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>)</a>
<a class="sourceLine" id="cb53-3" data-line-number="3">})</a>
<a class="sourceLine" id="cb53-4" data-line-number="4"><span class="kw">head</span>(us)</a>
<a class="sourceLine" id="cb53-5" data-line-number="5"><span class="co">##         date    county      state  fips cases deaths</span></a>
<a class="sourceLine" id="cb53-6" data-line-number="6"><span class="co">## 1 2020-01-21 Snohomish Washington 53061     1      0</span></a>
<a class="sourceLine" id="cb53-7" data-line-number="7"><span class="co">## 2 2020-01-22 Snohomish Washington 53061     1      0</span></a>
<a class="sourceLine" id="cb53-8" data-line-number="8"><span class="co">## 3 2020-01-23 Snohomish Washington 53061     1      0</span></a>
<a class="sourceLine" id="cb53-9" data-line-number="9"><span class="co">## 4 2020-01-24      Cook   Illinois 17031     1      0</span></a>
<a class="sourceLine" id="cb53-10" data-line-number="10"><span class="co">## 5 2020-01-24 Snohomish Washington 53061     1      0</span></a>
<a class="sourceLine" id="cb53-11" data-line-number="11"><span class="co">## 6 2020-01-25    Orange California  6059     1      0</span></a></code></pre></div></li>
</ul>
<p>Subset to only Erie county, New York state</p>
<ul>
<li><p>Subset, method 1</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1">row_idx &lt;-<span class="st"> </span>(us<span class="op">$</span>county <span class="op">==</span><span class="st"> &quot;Erie&quot;</span>) <span class="op">&amp;</span><span class="st"> </span>(us<span class="op">$</span>state <span class="op">==</span><span class="st"> &quot;New York&quot;</span>)</a>
<a class="sourceLine" id="cb54-2" data-line-number="2">erie &lt;-<span class="st"> </span>us[row_idx,]</a>
<a class="sourceLine" id="cb54-3" data-line-number="3"><span class="kw">dim</span>(erie)</a>
<a class="sourceLine" id="cb54-4" data-line-number="4"><span class="co">## [1] 36  6</span></a></code></pre></div></li>
<li><p>Subset, method 2</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1">erie &lt;-<span class="st"> </span><span class="kw">subset</span>(us, (county <span class="op">==</span><span class="st"> &quot;Erie&quot;</span>) <span class="op">&amp;</span><span class="st"> </span>(state <span class="op">==</span><span class="st"> &quot;New York&quot;</span>))</a>
<a class="sourceLine" id="cb55-2" data-line-number="2"><span class="kw">dim</span>(erie)</a>
<a class="sourceLine" id="cb55-3" data-line-number="3"><span class="co">## [1] 36  6</span></a></code></pre></div></li>
</ul>
<p>Manipulation</p>
<ul>
<li><p>Goal: calculate <code>new_cases</code> as the difference between succesive days, using <code>diff()</code></p></li>
<li><p>Remember use of <code>diff()</code></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" data-line-number="1"><span class="co">## example: `diff()` between successive numbers in a vector</span></a>
<a class="sourceLine" id="cb56-2" data-line-number="2">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">13</span>)</a>
<a class="sourceLine" id="cb56-3" data-line-number="3"><span class="kw">diff</span>(x)</a>
<a class="sourceLine" id="cb56-4" data-line-number="4"><span class="co">## [1] 0 1 1 2 3 5</span></a></code></pre></div></li>
<li><p>Update, methods 1 &amp; 2 (prepend a <code>0</code> when using <code>diff()</code>, to get the intial number of new cases)</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1"><span class="co">## one way...</span></a>
<a class="sourceLine" id="cb57-2" data-line-number="2">erie<span class="op">$</span>new_cases &lt;-<span class="st"> </span><span class="kw">diff</span>( <span class="kw">c</span>(<span class="dv">0</span>, erie<span class="op">$</span>cases) )</a>
<a class="sourceLine" id="cb57-3" data-line-number="3"></a>
<a class="sourceLine" id="cb57-4" data-line-number="4"><span class="co">## ...or another</span></a>
<a class="sourceLine" id="cb57-5" data-line-number="5">erie &lt;-<span class="st"> </span><span class="kw">within</span>(erie, {</a>
<a class="sourceLine" id="cb57-6" data-line-number="6">    new_cases &lt;-<span class="st"> </span><span class="kw">diff</span>( <span class="kw">c</span>(<span class="dv">0</span>, cases) )</a>
<a class="sourceLine" id="cb57-7" data-line-number="7">})</a></code></pre></div></li>
</ul>
<p>Summary: calculate maximum (total) number of cases per county in New York state</p>
<ul>
<li><p>For Erie county, let’s see how to calculate the maximum (total) number of cases</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" data-line-number="1"><span class="kw">max</span>(erie<span class="op">$</span>cases)        <span class="co"># one way...</span></a>
<a class="sourceLine" id="cb58-2" data-line-number="2"><span class="co">## [1] 2070</span></a>
<a class="sourceLine" id="cb58-3" data-line-number="3"><span class="kw">with</span>(erie, <span class="kw">max</span>(cases)) <span class="co"># ... another</span></a>
<a class="sourceLine" id="cb58-4" data-line-number="4"><span class="co">## [1] 2070</span></a></code></pre></div></li>
<li><p>Subset US data to New York state</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" data-line-number="1">ny_state &lt;-<span class="st"> </span><span class="kw">subset</span>(us, state <span class="op">==</span><span class="st"> &quot;New York&quot;</span>)</a></code></pre></div></li>
<li><p>Summarize each county in the state using <code>aggregate()</code>.</p>
<ul>
<li><p>First argument: summarize <code>cases</code> grouped by <code>county</code> – <code>cases ~ county</code></p></li>
<li><p>Second argument: data source – <code>ny_state</code></p></li>
<li><p>Third argument: function to apply to each subset – <code>max</code></p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" data-line-number="1">max_cases_by_county &lt;-<span class="st"> </span><span class="kw">aggregate</span>( cases <span class="op">~</span><span class="st"> </span>county, ny_state, max)</a>
<a class="sourceLine" id="cb60-2" data-line-number="2"><span class="kw">head</span>(max_cases_by_county)</a>
<a class="sourceLine" id="cb60-3" data-line-number="3"><span class="co">##        county cases</span></a>
<a class="sourceLine" id="cb60-4" data-line-number="4"><span class="co">## 1      Albany   682</span></a>
<a class="sourceLine" id="cb60-5" data-line-number="5"><span class="co">## 2    Allegany    30</span></a>
<a class="sourceLine" id="cb60-6" data-line-number="6"><span class="co">## 3      Broome   192</span></a>
<a class="sourceLine" id="cb60-7" data-line-number="7"><span class="co">## 4 Cattaraugus    34</span></a>
<a class="sourceLine" id="cb60-8" data-line-number="8"><span class="co">## 5      Cayuga    36</span></a>
<a class="sourceLine" id="cb60-9" data-line-number="9"><span class="co">## 6  Chautauqua    25</span></a></code></pre></div></li>
</ul></li>
<li><p><code>subset()</code> to select counties</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" data-line-number="1"><span class="kw">subset</span>(</a>
<a class="sourceLine" id="cb61-2" data-line-number="2">    max_cases_by_county,</a>
<a class="sourceLine" id="cb61-3" data-line-number="3">    county <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;New York City&quot;</span>, <span class="st">&quot;Westchester&quot;</span>, <span class="st">&quot;Erie&quot;</span>)</a>
<a class="sourceLine" id="cb61-4" data-line-number="4">)</a>
<a class="sourceLine" id="cb61-5" data-line-number="5"><span class="co">##           county  cases</span></a>
<a class="sourceLine" id="cb61-6" data-line-number="6"><span class="co">## 14          Erie   2070</span></a>
<a class="sourceLine" id="cb61-7" data-line-number="7"><span class="co">## 29 New York City 134446</span></a>
<a class="sourceLine" id="cb61-8" data-line-number="8"><span class="co">## 57   Westchester  23803</span></a></code></pre></div></li>
</ul>
<p>Summary: calculate maximum (total) number of cases per state</p>
<ul>
<li><p>Use entire data set, <code>us</code></p></li>
<li><p><code>aggregate()</code> cases by county <em>and</em> state – <code>cases ~ county + state</code></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" data-line-number="1">max_cases_by_county_state &lt;-</a>
<a class="sourceLine" id="cb62-2" data-line-number="2"><span class="st">    </span><span class="kw">aggregate</span>( cases <span class="op">~</span><span class="st"> </span>county <span class="op">+</span><span class="st"> </span>state, us, max )</a>
<a class="sourceLine" id="cb62-3" data-line-number="3"><span class="kw">dim</span>(max_cases_by_county_state)</a>
<a class="sourceLine" id="cb62-4" data-line-number="4"><span class="co">## [1] 2801    3</span></a>
<a class="sourceLine" id="cb62-5" data-line-number="5"><span class="kw">head</span>(max_cases_by_county_state)</a>
<a class="sourceLine" id="cb62-6" data-line-number="6"><span class="co">##    county   state cases</span></a>
<a class="sourceLine" id="cb62-7" data-line-number="7"><span class="co">## 1 Autauga Alabama    27</span></a>
<a class="sourceLine" id="cb62-8" data-line-number="8"><span class="co">## 2 Baldwin Alabama   114</span></a>
<a class="sourceLine" id="cb62-9" data-line-number="9"><span class="co">## 3 Barbour Alabama    20</span></a>
<a class="sourceLine" id="cb62-10" data-line-number="10"><span class="co">## 4    Bibb Alabama    28</span></a>
<a class="sourceLine" id="cb62-11" data-line-number="11"><span class="co">## 5  Blount Alabama    21</span></a>
<a class="sourceLine" id="cb62-12" data-line-number="12"><span class="co">## 6 Bullock Alabama     9</span></a></code></pre></div></li>
<li><p><code>aggregate()</code> a second time, using <code>max_cases_by_county_state</code> and aggregtaing by state</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" data-line-number="1">max_cases_by_state &lt;-</a>
<a class="sourceLine" id="cb63-2" data-line-number="2"><span class="st">    </span><span class="kw">aggregate</span>( cases <span class="op">~</span><span class="st"> </span>state, max_cases_by_county_state, max )</a></code></pre></div></li>
<li><p>Explore the data</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" data-line-number="1"><span class="kw">head</span>(max_cases_by_state)</a>
<a class="sourceLine" id="cb64-2" data-line-number="2"><span class="co">##        state cases</span></a>
<a class="sourceLine" id="cb64-3" data-line-number="3"><span class="co">## 1    Alabama   682</span></a>
<a class="sourceLine" id="cb64-4" data-line-number="4"><span class="co">## 2     Alaska   154</span></a>
<a class="sourceLine" id="cb64-5" data-line-number="5"><span class="co">## 3    Arizona  2589</span></a>
<a class="sourceLine" id="cb64-6" data-line-number="6"><span class="co">## 4   Arkansas   377</span></a>
<a class="sourceLine" id="cb64-7" data-line-number="7"><span class="co">## 5 California 12341</span></a>
<a class="sourceLine" id="cb64-8" data-line-number="8"><span class="co">## 6   Colorado  1784</span></a>
<a class="sourceLine" id="cb64-9" data-line-number="9"><span class="kw">subset</span>(</a>
<a class="sourceLine" id="cb64-10" data-line-number="10">    max_cases_by_state,</a>
<a class="sourceLine" id="cb64-11" data-line-number="11">    state <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;California&quot;</span>, <span class="st">&quot;Illinois&quot;</span>, <span class="st">&quot;New York&quot;</span>, <span class="st">&quot;Washington&quot;</span>)</a>
<a class="sourceLine" id="cb64-12" data-line-number="12">)</a>
<a class="sourceLine" id="cb64-13" data-line-number="13"><span class="co">##         state  cases</span></a>
<a class="sourceLine" id="cb64-14" data-line-number="14"><span class="co">## 5  California  12341</span></a>
<a class="sourceLine" id="cb64-15" data-line-number="15"><span class="co">## 15   Illinois  21272</span></a>
<a class="sourceLine" id="cb64-16" data-line-number="16"><span class="co">## 34   New York 134446</span></a>
<a class="sourceLine" id="cb64-17" data-line-number="17"><span class="co">## 52 Washington   5174</span></a></code></pre></div></li>
</ul>
</div>
</div>
<div id="day-12-friday-zoom-check-in" class="section level2">
<h2><span class="header-section-number">2.5</span> Day 12 (Friday) Zoom check-in</h2>
<div id="review-and-troubleshoot-20-minutes" class="section level3 unnumbered">
<h3>Review and troubleshoot (20 minutes)</h3>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" data-line-number="1"><span class="co">## retrieve and clean the current data set</span></a>
<a class="sourceLine" id="cb65-2" data-line-number="2">url &lt;-<span class="st"> &quot;https://raw.githubusercontent.com/nytimes/covid-19-data/master/us-counties.csv&quot;</span></a>
<a class="sourceLine" id="cb65-3" data-line-number="3">us &lt;-<span class="st"> </span><span class="kw">read.csv</span>(url, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb65-4" data-line-number="4">us &lt;-<span class="st"> </span><span class="kw">within</span>(us, {</a>
<a class="sourceLine" id="cb65-5" data-line-number="5">    date =<span class="st"> </span><span class="kw">as.Date</span>(date, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>)</a>
<a class="sourceLine" id="cb65-6" data-line-number="6">})</a>
<a class="sourceLine" id="cb65-7" data-line-number="7"></a>
<a class="sourceLine" id="cb65-8" data-line-number="8"><span class="co">## subset</span></a>
<a class="sourceLine" id="cb65-9" data-line-number="9">erie &lt;-<span class="st"> </span><span class="kw">subset</span>(us, (county <span class="op">==</span><span class="st"> &quot;Erie&quot;</span>) <span class="op">&amp;</span><span class="st"> </span>(state <span class="op">==</span><span class="st"> &quot;New York&quot;</span>))</a>
<a class="sourceLine" id="cb65-10" data-line-number="10"></a>
<a class="sourceLine" id="cb65-11" data-line-number="11"><span class="co">## manipulate</span></a>
<a class="sourceLine" id="cb65-12" data-line-number="12">erie &lt;-<span class="st"> </span><span class="kw">within</span>(erie, {</a>
<a class="sourceLine" id="cb65-13" data-line-number="13">    new_cases &lt;-<span class="st"> </span><span class="kw">diff</span>( <span class="kw">c</span>(<span class="dv">0</span>, cases) )</a>
<a class="sourceLine" id="cb65-14" data-line-number="14">})</a>
<a class="sourceLine" id="cb65-15" data-line-number="15"></a>
<a class="sourceLine" id="cb65-16" data-line-number="16"><span class="co">## record of cases to date</span></a>
<a class="sourceLine" id="cb65-17" data-line-number="17">erie</a>
<a class="sourceLine" id="cb65-18" data-line-number="18"><span class="co">##             date county    state  fips cases deaths new_cases</span></a>
<a class="sourceLine" id="cb65-19" data-line-number="19"><span class="co">## 2569  2020-03-15   Erie New York 36029     3      0         3</span></a>
<a class="sourceLine" id="cb65-20" data-line-number="20"><span class="co">## 3028  2020-03-16   Erie New York 36029     6      0         3</span></a>
<a class="sourceLine" id="cb65-21" data-line-number="21"><span class="co">## 3544  2020-03-17   Erie New York 36029     7      0         1</span></a>
<a class="sourceLine" id="cb65-22" data-line-number="22"><span class="co">## 4141  2020-03-18   Erie New York 36029     7      0         0</span></a>
<a class="sourceLine" id="cb65-23" data-line-number="23"><span class="co">## 4870  2020-03-19   Erie New York 36029    28      0        21</span></a>
<a class="sourceLine" id="cb65-24" data-line-number="24"><span class="co">## 5717  2020-03-20   Erie New York 36029    31      0         3</span></a>
<a class="sourceLine" id="cb65-25" data-line-number="25"><span class="co">## 6711  2020-03-21   Erie New York 36029    38      0         7</span></a>
<a class="sourceLine" id="cb65-26" data-line-number="26"><span class="co">## 7805  2020-03-22   Erie New York 36029    54      0        16</span></a>
<a class="sourceLine" id="cb65-27" data-line-number="27"><span class="co">## 9003  2020-03-23   Erie New York 36029    87      0        33</span></a>
<a class="sourceLine" id="cb65-28" data-line-number="28"><span class="co">## 10314 2020-03-24   Erie New York 36029   107      0        20</span></a>
<a class="sourceLine" id="cb65-29" data-line-number="29"><span class="co">## 11754 2020-03-25   Erie New York 36029   122      0        15</span></a>
<a class="sourceLine" id="cb65-30" data-line-number="30"><span class="co">## 13367 2020-03-26   Erie New York 36029   134      2        12</span></a>
<a class="sourceLine" id="cb65-31" data-line-number="31"><span class="co">## 15111 2020-03-27   Erie New York 36029   219      6        85</span></a>
<a class="sourceLine" id="cb65-32" data-line-number="32"><span class="co">## 16951 2020-03-28   Erie New York 36029   354      6       135</span></a>
<a class="sourceLine" id="cb65-33" data-line-number="33"><span class="co">## 18888 2020-03-29   Erie New York 36029   380      6        26</span></a>
<a class="sourceLine" id="cb65-34" data-line-number="34"><span class="co">## 20938 2020-03-30   Erie New York 36029   443      8        63</span></a>
<a class="sourceLine" id="cb65-35" data-line-number="35"><span class="co">## 23079 2020-03-31   Erie New York 36029   438      8        -5</span></a>
<a class="sourceLine" id="cb65-36" data-line-number="36"><span class="co">## 25283 2020-04-01   Erie New York 36029   553     12       115</span></a>
<a class="sourceLine" id="cb65-37" data-line-number="37"><span class="co">## 27544 2020-04-02   Erie New York 36029   734     19       181</span></a>
<a class="sourceLine" id="cb65-38" data-line-number="38"><span class="co">## 29866 2020-04-03   Erie New York 36029   802     22        68</span></a>
<a class="sourceLine" id="cb65-39" data-line-number="39"><span class="co">## 32254 2020-04-04   Erie New York 36029   945     26       143</span></a>
<a class="sourceLine" id="cb65-40" data-line-number="40"><span class="co">## 34687 2020-04-05   Erie New York 36029  1059     27       114</span></a>
<a class="sourceLine" id="cb65-41" data-line-number="41"><span class="co">## 37160 2020-04-06   Erie New York 36029  1163     30       104</span></a>
<a class="sourceLine" id="cb65-42" data-line-number="42"><span class="co">## 39674 2020-04-07   Erie New York 36029  1163     36         0</span></a>
<a class="sourceLine" id="cb65-43" data-line-number="43"><span class="co">## 42227 2020-04-08   Erie New York 36029  1205     38        42</span></a>
<a class="sourceLine" id="cb65-44" data-line-number="44"><span class="co">## 44803 2020-04-09   Erie New York 36029  1362     46       157</span></a>
<a class="sourceLine" id="cb65-45" data-line-number="45"><span class="co">## 47417 2020-04-10   Erie New York 36029  1409     58        47</span></a>
<a class="sourceLine" id="cb65-46" data-line-number="46"><span class="co">## 50071 2020-04-11   Erie New York 36029  1472     62        63</span></a>
<a class="sourceLine" id="cb65-47" data-line-number="47"><span class="co">## 52744 2020-04-12   Erie New York 36029  1571     75        99</span></a>
<a class="sourceLine" id="cb65-48" data-line-number="48"><span class="co">## 55428 2020-04-13   Erie New York 36029  1624     86        53</span></a>
<a class="sourceLine" id="cb65-49" data-line-number="49"><span class="co">## 58128 2020-04-14   Erie New York 36029  1668     99        44</span></a>
<a class="sourceLine" id="cb65-50" data-line-number="50"><span class="co">## 60844 2020-04-15   Erie New York 36029  1751    110        83</span></a>
<a class="sourceLine" id="cb65-51" data-line-number="51"><span class="co">## 63572 2020-04-16   Erie New York 36029  1850    115        99</span></a>
<a class="sourceLine" id="cb65-52" data-line-number="52"><span class="co">## 66316 2020-04-17   Erie New York 36029  1929    115        79</span></a>
<a class="sourceLine" id="cb65-53" data-line-number="53"><span class="co">## 69074 2020-04-18   Erie New York 36029  1997    115        68</span></a>
<a class="sourceLine" id="cb65-54" data-line-number="54"><span class="co">## 71842 2020-04-19   Erie New York 36029  2070    146        73</span></a>
<a class="sourceLine" id="cb65-55" data-line-number="55"></a>
<a class="sourceLine" id="cb65-56" data-line-number="56"><span class="co">## aggregate() cases in each county to find total (max) number</span></a>
<a class="sourceLine" id="cb65-57" data-line-number="57">ny_state &lt;-<span class="st"> </span><span class="kw">subset</span>(us, state <span class="op">==</span><span class="st"> &quot;New York&quot;</span>)</a>
<a class="sourceLine" id="cb65-58" data-line-number="58"><span class="kw">head</span>( <span class="kw">aggregate</span>(cases <span class="op">~</span><span class="st"> </span>county, ny_state, max) )</a>
<a class="sourceLine" id="cb65-59" data-line-number="59"><span class="co">##        county cases</span></a>
<a class="sourceLine" id="cb65-60" data-line-number="60"><span class="co">## 1      Albany   682</span></a>
<a class="sourceLine" id="cb65-61" data-line-number="61"><span class="co">## 2    Allegany    30</span></a>
<a class="sourceLine" id="cb65-62" data-line-number="62"><span class="co">## 3      Broome   192</span></a>
<a class="sourceLine" id="cb65-63" data-line-number="63"><span class="co">## 4 Cattaraugus    34</span></a>
<a class="sourceLine" id="cb65-64" data-line-number="64"><span class="co">## 5      Cayuga    36</span></a>
<a class="sourceLine" id="cb65-65" data-line-number="65"><span class="co">## 6  Chautauqua    25</span></a></code></pre></div>
</div>
<div id="visualization-20-minutes" class="section level3 unnumbered">
<h3>Visualization (20 minutes)</h3>
<p><code>plot</code> with a <code>formula</code> argument</p>
<ul>
<li><code>formula =</code>: use <code>~</code> (tilde) to describe the relationship to be plotted – <code>y-axis-variable ~ x-axis-variable</code></li>
<li><p><code>data =</code>: <code>data.frame</code> containing the variables to be plotted</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" data-line-number="1"><span class="kw">plot</span>( new_cases <span class="op">~</span><span class="st"> </span>date, erie )</a></code></pre></div>
<p><img src="02-DataFrame_files/figure-html/unnamed-chunk-69-1.png" width="672" /></p></li>
<li><p>Additional arguments control, e.g., point shape used for plotting (<code>pch =</code>), log-transformation of axes (<code>log =</code>), title (<code>main =</code>)</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" data-line-number="1"><span class="kw">plot</span>( new_cases <span class="op">~</span><span class="st"> </span>date, erie, <span class="dt">log =</span> <span class="st">&quot;y&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Erie County&quot;</span> )</a>
<a class="sourceLine" id="cb67-2" data-line-number="2"><span class="co">## Warning in xy.coords(x, y, xlabel, ylabel, log): 3 y values &lt;= 0 omitted from</span></a>
<a class="sourceLine" id="cb67-3" data-line-number="3"><span class="co">## logarithmic plot</span></a></code></pre></div>
<p><img src="02-DataFrame_files/figure-html/unnamed-chunk-70-1.png" width="672" /></p></li>
</ul>
<p>Help!</p>
<ul>
<li><code>?plot.formula</code></li>
<li><code>?plot.default</code></li>
</ul>
</div>
<div id="functions-20-minutes" class="section level3 unnumbered">
<h3>Functions (20 minutes)</h3>
<p>Anatomy of a function</p>
<ul>
<li><p><em>Symbol</em> representing the variable that will be used to hold the function</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" data-line-number="1">plot_county &lt;-<span class="st"> </span>...</a></code></pre></div></li>
<li><p><code>function</code> key word, followed by required (no default value) and optional arguments</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" data-line-number="1">plot_county &lt;-</a>
<a class="sourceLine" id="cb69-2" data-line-number="2"><span class="st">    </span><span class="cf">function</span>(us_data, <span class="dt">state =</span> <span class="st">&quot;New York&quot;</span>, <span class="dt">county =</span> <span class="st">&quot;Erie&quot;</span>)</a></code></pre></div></li>
<li><p><code>body</code> defining the what the function is supposed to do, enclosed in braces <code>{</code>, <code>}</code>. The body uses variables passed in as arguments, as well as other functions in base <em>R</em>.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" data-line-number="1">plot_county &lt;-</a>
<a class="sourceLine" id="cb70-2" data-line-number="2"><span class="st">    </span><span class="cf">function</span>(us_data, <span class="dt">which_state =</span> <span class="st">&quot;New York&quot;</span>, <span class="dt">which_county =</span> <span class="st">&quot;Erie&quot;</span>)</a>
<a class="sourceLine" id="cb70-3" data-line-number="3">{</a>
<a class="sourceLine" id="cb70-4" data-line-number="4">    <span class="co">## subset to state and county</span></a>
<a class="sourceLine" id="cb70-5" data-line-number="5">    county &lt;-<span class="st"> </span><span class="kw">subset</span>(us_data, (state <span class="op">==</span><span class="st"> </span>which_state) <span class="op">&amp;</span><span class="st"> </span>(county <span class="op">==</span><span class="st"> </span>which_county))</a>
<a class="sourceLine" id="cb70-6" data-line-number="6"></a>
<a class="sourceLine" id="cb70-7" data-line-number="7">    <span class="co">## calculate new_cases</span></a>
<a class="sourceLine" id="cb70-8" data-line-number="8">    county &lt;-<span class="st"> </span><span class="kw">within</span>(county, {</a>
<a class="sourceLine" id="cb70-9" data-line-number="9">        new_cases &lt;-<span class="st"> </span><span class="kw">diff</span>( <span class="kw">c</span>(<span class="dv">0</span>, cases) )</a>
<a class="sourceLine" id="cb70-10" data-line-number="10">    })</a>
<a class="sourceLine" id="cb70-11" data-line-number="11"></a>
<a class="sourceLine" id="cb70-12" data-line-number="12">    <span class="co">## create title and plot</span></a>
<a class="sourceLine" id="cb70-13" data-line-number="13">    title &lt;-<span class="st"> </span><span class="kw">paste0</span>(which_county, <span class="st">&quot;, &quot;</span>, which_state)</a>
<a class="sourceLine" id="cb70-14" data-line-number="14">    <span class="kw">plot</span>( new_cases <span class="op">~</span><span class="st"> </span>date, county, <span class="dt">log =</span> <span class="st">&quot;y&quot;</span>, <span class="dt">main =</span> title )</a>
<a class="sourceLine" id="cb70-15" data-line-number="15">}</a></code></pre></div></li>
</ul>
<p>Use</p>
<ul>
<li><p>Provide all arguments…</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" data-line-number="1"><span class="kw">plot_county</span>(us, <span class="st">&quot;New York&quot;</span>, <span class="st">&quot;Westchester&quot;</span>)</a></code></pre></div>
<p><img src="02-DataFrame_files/figure-html/unnamed-chunk-74-1.png" width="672" /></p></li>
<li><p>… or use one or more defaults</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" data-line-number="1"><span class="kw">plot_county</span>(us, <span class="dt">which_county =</span> <span class="st">&quot;Erie&quot;</span>)</a>
<a class="sourceLine" id="cb72-2" data-line-number="2"><span class="co">## Warning in xy.coords(x, y, xlabel, ylabel, log): 3 y values &lt;= 0 omitted from</span></a>
<a class="sourceLine" id="cb72-3" data-line-number="3"><span class="co">## logarithmic plot</span></a></code></pre></div>
<p><img src="02-DataFrame_files/figure-html/unnamed-chunk-75-1.png" width="672" /></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" data-line-number="1"><span class="kw">plot_county</span>(us, <span class="st">&quot;Washington&quot;</span>, <span class="st">&quot;King&quot;</span>) <span class="co"># Seattle</span></a>
<a class="sourceLine" id="cb73-2" data-line-number="2"><span class="co">## Warning in xy.coords(x, y, xlabel, ylabel, log): 1 y value &lt;= 0 omitted from</span></a>
<a class="sourceLine" id="cb73-3" data-line-number="3"><span class="co">## logarithmic plot</span></a></code></pre></div>
<p><img src="02-DataFrame_files/figure-html/unnamed-chunk-75-2.png" width="672" /></p></li>
</ul>
</div>
</div>
<div id="day-13-basic-visualization" class="section level2">
<h2><span class="header-section-number">2.6</span> Day 13: Basic visualization</h2>
<p>Let’s get the current Erie county data, and create the <code>new_cases</code> column</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" data-line-number="1"><span class="co">## retrieve and clean the current data set</span></a>
<a class="sourceLine" id="cb74-2" data-line-number="2">url &lt;-<span class="st"> &quot;https://raw.githubusercontent.com/nytimes/covid-19-data/master/us-counties.csv&quot;</span></a>
<a class="sourceLine" id="cb74-3" data-line-number="3">us &lt;-<span class="st"> </span><span class="kw">read.csv</span>(url, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb74-4" data-line-number="4">us &lt;-<span class="st"> </span><span class="kw">within</span>(us, {</a>
<a class="sourceLine" id="cb74-5" data-line-number="5">    date =<span class="st"> </span><span class="kw">as.Date</span>(date, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>)</a>
<a class="sourceLine" id="cb74-6" data-line-number="6">})</a>
<a class="sourceLine" id="cb74-7" data-line-number="7"></a>
<a class="sourceLine" id="cb74-8" data-line-number="8"><span class="co">## get the Erie county subset</span></a>
<a class="sourceLine" id="cb74-9" data-line-number="9">erie &lt;-<span class="st"> </span><span class="kw">subset</span>(us, (county <span class="op">==</span><span class="st"> &quot;Erie&quot;</span>) <span class="op">&amp;</span><span class="st"> </span>(state <span class="op">==</span><span class="st"> &quot;New York&quot;</span>))</a>
<a class="sourceLine" id="cb74-10" data-line-number="10"></a>
<a class="sourceLine" id="cb74-11" data-line-number="11"><span class="co">## add the `new_cases` column</span></a>
<a class="sourceLine" id="cb74-12" data-line-number="12">erie &lt;-<span class="st"> </span><span class="kw">within</span>(erie, {</a>
<a class="sourceLine" id="cb74-13" data-line-number="13">    new_cases &lt;-<span class="st"> </span><span class="kw">diff</span>( <span class="kw">c</span>(<span class="dv">0</span>, cases) )</a>
<a class="sourceLine" id="cb74-14" data-line-number="14">})</a></code></pre></div>
<p>Simple visualization</p>
<ul>
<li><p>We’ll use the <code>plot()</code> function to create a visualization of the progression of COVID cases in Erie county.</p></li>
<li><p><code>plot()</code> can be used with a <code>formula</code>, similar to how we used <code>aggregate()</code>.</p></li>
<li><p>The <code>formula</code> describes the independent (y-axis) variable as a function of the dependent (x-axis) variable</p></li>
<li><p>For our case, the formula will be <code>cases ~ date</code>, i.e., plot the number of cases on the y-axis, and date on the x-axis.</p></li>
<li><p>As with <code>aggregate()</code>, we need to provide, in the second argument, the <code>data.frame</code> where the variables to be plotted can be found.</p></li>
<li><p>Ok, here we go…</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" data-line-number="1"><span class="kw">plot</span>( cases <span class="op">~</span><span class="st"> </span>date, erie)</a></code></pre></div>
<p><img src="02-DataFrame_files/figure-html/unnamed-chunk-77-1.png" width="672" /></p></li>
<li><p>It might be maybe more informative to plot new cases (so that we can see more easily whether social distancing and other measures are having an effect on the spread of COVID cases. Using log-transformed new cases helps to convey the proportional increase</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" data-line-number="1"><span class="kw">plot</span>( new_cases <span class="op">~</span><span class="st"> </span>date, erie, <span class="dt">log =</span> <span class="st">&quot;y&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;New Cases, Erie County&quot;</span> )</a>
<a class="sourceLine" id="cb76-2" data-line-number="2"><span class="co">## Warning in xy.coords(x, y, xlabel, ylabel, log): 3 y values &lt;= 0 omitted from</span></a>
<a class="sourceLine" id="cb76-3" data-line-number="3"><span class="co">## logarithmic plot</span></a></code></pre></div>
<p><img src="02-DataFrame_files/figure-html/unnamed-chunk-78-1.png" width="672" /></p></li>
<li><p>See <code>?plot.formula</code> for some options available when using the formula interface to plot. Additional arguments are described on the help page <code>?help.default</code>.</p></li>
</ul>
</div>
<div id="day-14-functions" class="section level2">
<h2><span class="header-section-number">2.7</span> Day 14: Functions</h2>
<p>Yesterday we created a plot for Erie county. The steps to create this plot can be separated into two parts</p>
<ol style="list-style-type: decimal">
<li><p>Get the full data</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" data-line-number="1">url &lt;-<span class="st"> &quot;https://raw.githubusercontent.com/nytimes/covid-19-data/master/us-counties.csv&quot;</span></a>
<a class="sourceLine" id="cb77-2" data-line-number="2">us &lt;-<span class="st"> </span><span class="kw">read.csv</span>(url, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb77-3" data-line-number="3">us &lt;-<span class="st"> </span><span class="kw">within</span>(us, {</a>
<a class="sourceLine" id="cb77-4" data-line-number="4">    date =<span class="st"> </span><span class="kw">as.Date</span>(date, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>)</a>
<a class="sourceLine" id="cb77-5" data-line-number="5">})</a></code></pre></div></li>
<li><p>Subset, update, and plot the data for county of interest</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" data-line-number="1">erie &lt;-<span class="st"> </span><span class="kw">subset</span>(us, (county <span class="op">==</span><span class="st"> &quot;Erie&quot;</span>) <span class="op">&amp;</span><span class="st"> </span>(state <span class="op">==</span><span class="st"> &quot;New York&quot;</span>))</a>
<a class="sourceLine" id="cb78-2" data-line-number="2">erie &lt;-<span class="st"> </span><span class="kw">within</span>(erie, {</a>
<a class="sourceLine" id="cb78-3" data-line-number="3">    new_cases &lt;-<span class="st"> </span><span class="kw">diff</span>( <span class="kw">c</span>(<span class="dv">0</span>, cases) )</a>
<a class="sourceLine" id="cb78-4" data-line-number="4">})</a>
<a class="sourceLine" id="cb78-5" data-line-number="5"><span class="kw">plot</span>( new_cases <span class="op">~</span><span class="st"> </span>date, erie, <span class="dt">log =</span> <span class="st">&quot;y&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;New Cases, Erie County&quot;</span> )</a>
<a class="sourceLine" id="cb78-6" data-line-number="6"><span class="co">## Warning in xy.coords(x, y, xlabel, ylabel, log): 3 y values &lt;= 0 omitted from</span></a>
<a class="sourceLine" id="cb78-7" data-line-number="7"><span class="co">## logarithmic plot</span></a></code></pre></div>
<p><img src="02-DataFrame_files/figure-html/unnamed-chunk-80-1.png" width="672" /></p></li>
</ol>
<p>What if we were interested in a different county? We could repeat (cut-and-paste) step 2, updating and generalizing a little</p>
<ul>
<li><p>Define a new variable to indicate the county we are interested in plotting</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" data-line-number="1">county_of_interest &lt;-<span class="st"> &quot;Westchester&quot;</span></a></code></pre></div></li>
<li><p><code>paste()</code> concatenates its arguments together into a single character vector. We use this to construct the title of the plot</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" data-line-number="1">main_title &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;New Cases,&quot;</span>, county_of_interest, <span class="st">&quot;County&quot;</span>)</a></code></pre></div></li>
<li><p>Now create and update a subset of the data for the county that we are interested in</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" data-line-number="1">    county_data &lt;-</a>
<a class="sourceLine" id="cb81-2" data-line-number="2"><span class="st">   </span><span class="kw">subset</span>(us, (county <span class="op">==</span><span class="st"> </span>county_of_interest) <span class="op">&amp;</span><span class="st"> </span>(state <span class="op">==</span><span class="st"> &quot;New York&quot;</span>))</a>
<a class="sourceLine" id="cb81-3" data-line-number="3">    county_data &lt;-<span class="st"> </span><span class="kw">within</span>(county_data, {</a>
<a class="sourceLine" id="cb81-4" data-line-number="4">   new_cases &lt;-<span class="st"> </span><span class="kw">diff</span>( <span class="kw">c</span>(<span class="dv">0</span>, cases) )</a>
<a class="sourceLine" id="cb81-5" data-line-number="5">    })</a></code></pre></div></li>
<li><p>… and finally plot the county data</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" data-line-number="1"><span class="kw">plot</span>( new_cases <span class="op">~</span><span class="st"> </span>date, county_data, <span class="dt">log =</span> <span class="st">&quot;y&quot;</span>, <span class="dt">main =</span> main_title)</a></code></pre></div>
<p><img src="02-DataFrame_files/figure-html/unnamed-chunk-84-1.png" width="672" /></p></li>
<li><p>Here is the generalization</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" data-line-number="1">county_of_interest &lt;-<span class="st"> &quot;Westchester&quot;</span></a>
<a class="sourceLine" id="cb83-2" data-line-number="2"></a>
<a class="sourceLine" id="cb83-3" data-line-number="3">main_title &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;New Cases,&quot;</span>, county_of_interest, <span class="st">&quot;County&quot;</span>)</a>
<a class="sourceLine" id="cb83-4" data-line-number="4">county_data &lt;-</a>
<a class="sourceLine" id="cb83-5" data-line-number="5"><span class="st">    </span><span class="kw">subset</span>(us_data, (county <span class="op">==</span><span class="st"> </span>county_of_interest) <span class="op">&amp;</span><span class="st"> </span>(state <span class="op">==</span><span class="st"> &quot;New York&quot;</span>))</a>
<a class="sourceLine" id="cb83-6" data-line-number="6">county_data &lt;-<span class="st"> </span><span class="kw">within</span>(county_data, {</a>
<a class="sourceLine" id="cb83-7" data-line-number="7">    new_cases &lt;-<span class="st"> </span><span class="kw">diff</span>( <span class="kw">c</span>(<span class="dv">0</span>, cases) )</a>
<a class="sourceLine" id="cb83-8" data-line-number="8">})</a>
<a class="sourceLine" id="cb83-9" data-line-number="9"><span class="kw">plot</span>( new_cases <span class="op">~</span><span class="st"> </span>date, county_data, <span class="dt">log =</span> <span class="st">&quot;y&quot;</span>, <span class="dt">main =</span> main_title)</a></code></pre></div></li>
</ul>
<p>It would be tedious and error-prone to copy and paste this code for each county we were interested in.</p>
<p>A better approach is to write a <code>function</code> that takes as inputs the <code>us</code> data.frame, and the name of the county that we want to plot. Functions are easy to write</p>
<ul>
<li><p>Create a variable to contain the function, use the keyword <code>function</code> and then the arguments you want to pass in.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" data-line-number="1">plot_county &lt;-</a>
<a class="sourceLine" id="cb84-2" data-line-number="2"><span class="st">    </span><span class="cf">function</span>(us_data, county_of_interest)</a></code></pre></div></li>
<li><p>… then provide the ‘body’ of the function between curly braces</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" data-line-number="1">{</a>
<a class="sourceLine" id="cb85-2" data-line-number="2">    main_title &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;New Cases,&quot;</span>, county_of_interest, <span class="st">&quot;County&quot;</span>)</a>
<a class="sourceLine" id="cb85-3" data-line-number="3">    county_data &lt;-</a>
<a class="sourceLine" id="cb85-4" data-line-number="4"><span class="st">        </span><span class="kw">subset</span>(us_data, (county <span class="op">==</span><span class="st"> </span>county_of_interest) <span class="op">&amp;</span><span class="st"> </span>(state <span class="op">==</span><span class="st"> &quot;New York&quot;</span>))</a>
<a class="sourceLine" id="cb85-5" data-line-number="5">    county_data &lt;-<span class="st"> </span><span class="kw">within</span>(county_data, {</a>
<a class="sourceLine" id="cb85-6" data-line-number="6">        new_cases &lt;-<span class="st"> </span><span class="kw">diff</span>( <span class="kw">c</span>(<span class="dv">0</span>, cases) )</a>
<a class="sourceLine" id="cb85-7" data-line-number="7">    })</a>
<a class="sourceLine" id="cb85-8" data-line-number="8"></a>
<a class="sourceLine" id="cb85-9" data-line-number="9">    <span class="kw">plot</span>( new_cases <span class="op">~</span><span class="st"> </span>date, county_data, <span class="dt">log =</span> <span class="st">&quot;y&quot;</span>, <span class="dt">main =</span> main_title)</a>
<a class="sourceLine" id="cb85-10" data-line-number="10">}</a></code></pre></div></li>
<li><p>Normally, the last evaluated line of the code (the <code>plot()</code> statement in our example) is returned from the function and can be captured by a variable. In our specific case, <code>plot()</code> creates the plot as a <em>side effect</em>, and the return value is actually the special symbol <code>NULL</code>.</p></li>
<li><p>Here’s the full definition</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" data-line-number="1">plot_county &lt;-</a>
<a class="sourceLine" id="cb86-2" data-line-number="2"><span class="st">    </span><span class="cf">function</span>(us_data, county_of_interest)</a>
<a class="sourceLine" id="cb86-3" data-line-number="3">{</a>
<a class="sourceLine" id="cb86-4" data-line-number="4">    main_title &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;New Cases,&quot;</span>, county_of_interest, <span class="st">&quot;County&quot;</span>)</a>
<a class="sourceLine" id="cb86-5" data-line-number="5">    county_data &lt;-</a>
<a class="sourceLine" id="cb86-6" data-line-number="6"><span class="st">        </span><span class="kw">subset</span>(us_data, (county <span class="op">==</span><span class="st"> </span>county_of_interest) <span class="op">&amp;</span><span class="st"> </span>(state <span class="op">==</span><span class="st"> &quot;New York&quot;</span>))</a>
<a class="sourceLine" id="cb86-7" data-line-number="7">    county_data &lt;-<span class="st"> </span><span class="kw">within</span>(county_data, {</a>
<a class="sourceLine" id="cb86-8" data-line-number="8">        new_cases &lt;-<span class="st"> </span><span class="kw">diff</span>( <span class="kw">c</span>(<span class="dv">0</span>, cases) )</a>
<a class="sourceLine" id="cb86-9" data-line-number="9">    })</a>
<a class="sourceLine" id="cb86-10" data-line-number="10"></a>
<a class="sourceLine" id="cb86-11" data-line-number="11">    <span class="kw">plot</span>( new_cases <span class="op">~</span><span class="st"> </span>date, county_data, <span class="dt">log =</span> <span class="st">&quot;y&quot;</span>, <span class="dt">main =</span> main_title)</a>
<a class="sourceLine" id="cb86-12" data-line-number="12">}</a></code></pre></div></li>
<li><p>Run the code defining the function in the <em>R</em> console, then use it to plot different counties:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" data-line-number="1"><span class="kw">plot_county</span>(us, <span class="st">&quot;Erie&quot;</span>)</a>
<a class="sourceLine" id="cb87-2" data-line-number="2"><span class="co">## Warning in xy.coords(x, y, xlabel, ylabel, log): 3 y values &lt;= 0 omitted from</span></a>
<a class="sourceLine" id="cb87-3" data-line-number="3"><span class="co">## logarithmic plot</span></a></code></pre></div>
<p><img src="02-DataFrame_files/figure-html/unnamed-chunk-89-1.png" width="672" /></p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" data-line-number="1"><span class="kw">plot_county</span>(us, <span class="st">&quot;Westchester&quot;</span>)</a></code></pre></div>
<p><img src="02-DataFrame_files/figure-html/unnamed-chunk-89-2.png" width="672" /></p></li>
</ul>
<p>Hmm, come to think of it, we might want to write a simple function to get and clean the US data.</p>
<ul>
<li><p>Get and clean the US data; we don’t need any arguments, and the return value (the last line of code evaluated) is the cleaned data</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" data-line-number="1">get_US_data &lt;-</a>
<a class="sourceLine" id="cb89-2" data-line-number="2"><span class="st">    </span><span class="cf">function</span>()</a>
<a class="sourceLine" id="cb89-3" data-line-number="3">{</a>
<a class="sourceLine" id="cb89-4" data-line-number="4">    url &lt;-<span class="st"> &quot;https://raw.githubusercontent.com/nytimes/covid-19-data/master/us-counties.csv&quot;</span></a>
<a class="sourceLine" id="cb89-5" data-line-number="5">    us &lt;-<span class="st"> </span><span class="kw">read.csv</span>(url, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb89-6" data-line-number="6">    <span class="kw">within</span>(us, {</a>
<a class="sourceLine" id="cb89-7" data-line-number="7">        date =<span class="st"> </span><span class="kw">as.Date</span>(date, <span class="dt">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>)</a>
<a class="sourceLine" id="cb89-8" data-line-number="8">    })</a>
<a class="sourceLine" id="cb89-9" data-line-number="9">}</a></code></pre></div></li>
<li><p>Verify that it is now just two lines to plot county-level data</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" data-line-number="1">us &lt;-<span class="st"> </span><span class="kw">get_US_data</span>()</a>
<a class="sourceLine" id="cb90-2" data-line-number="2"><span class="kw">plot_county</span>(us, <span class="st">&quot;Erie&quot;</span>)</a>
<a class="sourceLine" id="cb90-3" data-line-number="3"><span class="co">## Warning in xy.coords(x, y, xlabel, ylabel, log): 3 y values &lt;= 0 omitted from</span></a>
<a class="sourceLine" id="cb90-4" data-line-number="4"><span class="co">## logarithmic plot</span></a></code></pre></div>
<p><img src="02-DataFrame_files/figure-html/unnamed-chunk-91-1.png" width="672" /></p></li>
<li><p>How could you generalize <code>plot_county()</code> to plot county-level data for a county in any state? Hint: add a <code>state =</code> argument, perhaps using default values</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" data-line-number="1">plot_county &lt;-</a>
<a class="sourceLine" id="cb91-2" data-line-number="2"><span class="st">    </span><span class="cf">function</span>(us_data, <span class="dt">county =</span> <span class="st">&quot;Erie&quot;</span>, <span class="dt">state =</span> <span class="st">&quot;New York&quot;</span>)</a>
<a class="sourceLine" id="cb91-3" data-line-number="3">{</a>
<a class="sourceLine" id="cb91-4" data-line-number="4">    <span class="co">## your code here!</span></a>
<a class="sourceLine" id="cb91-5" data-line-number="5">}</a></code></pre></div></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="one.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="three.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["QuaRantine.pdf", "QuaRantine.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
